webpackJsonp([6,163,164,166,168,169,171,173],{26:function(e,t){window.PowrHideShow=function(){this.show=this.show||function(){return this.$body.show(),this},this.hide=this.hide||function(){return this.$body.hide(),this}}},264:function(e,t,i){i(45),window.formElementsSettingsModule=function(e,t){this.backboneView=e,this.$el=e.$el,this.model=e.model,this.formDataKey="data",this.paymentRequiredKey="paymentRequired",this.paypalItemCostKey="paypalItemCost",this.discountTypeKey="discountType";for(var i in t)this[i]=t[i];this.initialize()},formElementsSettingsModule.prototype={_showHideFileSizeNotifications:function(e,t){var i;if(i="wix"==HOST?t.parent().parent().siblings(".fileSizeNotificationEl"):t.parent().siblings(".fileSizeNotificationEl"),"file"!==e)return i.hide();var n=this.model.meta.premium_status;i.each(function(e){var t=$(this);t.attr("data-premium-status")===n?(t.css("display","block"),"enterprise"===n&&(t.find("a").removeClass("triggerPremium"),t.find("a").attr("href","mailto:support@powr.io").attr("target","_blank"))):t.hide()})},initialize:function(){var e=this;this.$el.on("click",".elementItem .formadd",function(t){if($(this).hasClass("premium")){shakeButton($(".newUpgrade"));var i=$(".formadd.premium").not($(this)[0]);return i.popover("hide"),i.next(".popover").hide(),t.stopPropagation(),!1}var n=$(this).data("type");"step"===n&&(e.model.setLocals({editingSteps:!0}),e.model.set({multistepForm:!0}),e.backboneView.handleMultistepForms());var a=$("#formElementSettingsTemplate").html(),o=_.template(a)({type:n,idx:e.model.get("data").length});e.$el.find(".formElementsWrapper").addPrototype(function(t){switch(t.find(".form-details").html(o),-1==$.inArray(n,["space","step"])&&t.find(".toggleSpace").click(),e.backboneView.updateInputFields(),e.backboneView.validateExternalFields(),e.backboneView.initializeSliders(),e.renderMediaBars(),t.find('[name="characterLimit"]').each(function(){0===$(this).val().toString().length&&$(this).val(250)}),t.find('[name="paragraphHeight"]').each(function(){0===$(this).val().toString().length&&$(this).val("50px")}),t.find(".optionsOpenTrigger").click(),n){case"address":t.find('[name="label"]').val("Address");break;case"email":t.find('[name="label"]').val("Email");break;case"phone":t.find('[name="label"]').val("Phone");break;case"number":t.find('[name="label"]').val("Number");break;case"image":t.find('[name="label"]').val("Image");break;case"radioimage":t.find('[name="label"]').val("Images");break;case"checkbox":t.find('[name="label"]').val("Checkbox");break;case"select":t.find('[name="label"]').val("Dropdown");break;case"date":t.find('[name="label"]').val("Date");break;case"file":t.find('[name="label"]').val("File"),t.find('[name="fileType"]').val("all");break;case"url":t.find('[name="label"]').val("URL");break;case"signature":t.find('[name="label"]').val("Signature");break;case"text":t.find('[name="label"]').val("Text");break;case"textarea":t.find('[name="label"]').val("Paragraph");break;case"radio":t.find('[name="label"]').val("Multiple Choice"),[1,2].forEach(function(e){optEl=t.find(".optionsWrapper").addPrototype(null,{speed:"instant"}),optEl.objectToForm({name:"Option "+e,priceChange:""})});break;case"multipleCheckbox":t.find('[name="label"]').val("Multiple Checkboxes"),[1,2].forEach(function(e){optEl=t.find(".optionsWrapper").addPrototype(null,{speed:"instant"}),optEl.objectToForm({name:"Option "+e,priceChange:""})});break;default:t.find('[name="label"]').val("Enter a Label")}e.backboneView.update(),e.backboneView.updatePremiumContent(),e.$el.find("#elementsModal").modal("hide")})}),this.$el.on("keyup",".formElementsWrapper [name=label]",function(){"undefined"!=typeof BAD_WORD_VALIDATION_TIMER&&clearTimeout(BAD_WORD_VALIDATION_TIMER);var t=$(this);window.BAD_WORD_VALIDATION_TIMER=setTimeout(function(){var i=[],n=["postcard","pittsford"],a=["credit card","credit card number","ccn"],o=t.parents(".prototype-element").find(".validation");o.hide().html("");for(var r=t.val(),s=function(i,a){var s=r.toLowerCase().match(i);if(s){var l=s.length,d=1===l,u=$.inArray(s[0],n)>-1;if(d&&u)return;if(r.toLowerCase().search(i)>-1){o.html(a(i)).fadeIn();var c=new RegExp(i,"ig");t.val(r.replace(c,"")),e.backboneView.update()}}},l=0;l<i.length;l++)s(i[l],function(e){return'<i class="fa fa-warning"></i> This form cannot collect password information. <a target="_blank" href="mailto:support@powr.io">Need help?</a>'});for(var l=0;l<a.length;l++)s(a[l],function(e){return'<i class="fa fa-warning"></i> This form cannot collect '+e+' information here. Instead, try enabling payments. <a target="_blank" href="mailto:support@powr.io">Need help?</a>'})},500)});var t=function(e,t){var i=t.split(/,|\n|\r/g).map(function(e){return e.trim()}).filter(function(e){return e.length>0});if(i.length<2)return!1;var n=e.closest(".formElements").find(".optionsWrapper");return 0==$(document.activeElement).val().trim().length&&$(document.activeElement).closest(".options").objectToForm({name:i.shift(),priceChange:""}),_.each(i,function(e){n.addPrototype(null,{speed:"instant"}).objectToForm({name:e,priceChange:""})}),!0};this.$el.on("paste",".optionInput input",function(e){var e=e.originalEvent||e,i=$(this);if(e&&e.clipboardData&&e.clipboardData.getData){var n=e.clipboardData.getData("text/plain");if(n&&t(i,n))return e.stopPropagation(),e.preventDefault(),!1}setTimeout(function(){t(i,i.val())},50)})},renderFormElements:function(e,t){var i=this.model.get("locals").expandedPanels||[],n=this.model.get("locals").expandedAdvancedSections||[];e=e||0,this.$el.find(".formElements.prototype-element:not(.prototype)").remove(),this.$el.find(".discountWrapper .discount:not(.prototype)").remove();var a=this,o=jQuery.extend(!0,{},this.model.get(this.formDataKey)),r=$("#formElementSettingsTemplate").html();for(var s in o){var l=this.$el.find(".formElementsWrapper.prototype-wrapper").addPrototype(null,{speed:"instant"}),d=o[s],u=[];void 0!==d.options&&null!=d.options&&(d.options=$.map(d.options,function(e,t){return u[t]=u[t]||{},u[t].option=e,[e]}),d.options=d.options.join(", ")),void 0!==d.prices&&d.prices&&(d.prices=$.map(d.prices,function(e,t){return u[t]=u[t]||{},u[t].price=e,[e]}),d.prices=d.prices.join(", ")),void 0!==d.altTags&&d.altTag&&(d.altTags=$.map(d.altTags,function(e,t){return u[t]=u[t]||{},u[t].altTag=e,[e]})),u.altTags=d.altTags;var c=_.template(r)({type:d.type,idx:s});l.find(".form-details").html(c),l.objectToForm(d),d.limitingCharacters&&l.find(".form-details").find(".whenLimiting").slideDown(),i.indexOf(s)>=0&&l.find(".panel-collapse").show(),n.indexOf(s)>=0&&(l.find(".showText").removeClass("showText").addClass("hideText"),l.find(".advanced").show()),a.model.get("multistepForm")&&("step"===d.type?(l.find(".toggleSpace").removeClass("toggleSpace"),l.find(".truncated").removeClass("truncated")):l.find(".mediaBar").css("padding-left","50px")),u.length>0&&(debug()(u),_.each(u,function(e){$(l).find(".optionsWrapper").addPrototype(null,{speed:"instant"}).objectToForm({name:e.option||"",priceChange:e.price||"",altTag:e.altTag||""})}))}for(var s in a.model.get("discounts")){var p=a.model.get("discounts")[s];this.$el.find(".discountWrapper").addPrototype(null,{speed:"instant"}).objectToForm(p)}if(a.$el.find('[name="characterLimit"]').each(function(){0==$(this).val().toString().length&&$(this).val(250)}),a.$el.find('[name="paragraphHeight"]').each(function(){0==$(this).val().toString().length&&$(this).val("50px")}),"free"!==a.model.meta.premium_status&&a.$el.find(".conditionalLogic").find(".premium").removeClass("premium"),"wix"===HOST)var m=a.$el.find(".wixSection.connectTabSelector");else var m=a.$el.find(".connect");if(m.scrollTop(e),this.backboneView.initializeInputs(),this.backboneView.initializeSliders(),this.backboneView.initializeImagePickers(),this.renderMediaBars(),this.updateConditionalLogic(),t){var h=t.parent().prop("id");$("#"+h).find("input").focus()}},renderMediaBars:function(){var e=1;for(var t in this.model.get(this.formDataKey)){var i=this.model.get(this.formDataKey)[t],n=$(this.$el.find(".formElements.prototype-element:not(.prototype)")[t]),a=i.label||"";if(0==a.length)switch(i.type){case"text":a="Single Line Text";break;case"textarea":a="Paragraph Text";break;case"select":a="Dropdown";break;case"radio":a="Multiple Choice";break;case"checkbox":a="Checkbox";break;case"multipleCheckbox":a="Multiple Checkboxes";break;case"radioimage":a="Multiple Images";break;case"date":a="Date and Time";break;case"email":a="Email";break;case"file":a="File Upload";break;case"image":a="Image";break;case"label":a="Label";break;case"linebreak":a="Line Break";break;case"number":a="Number";break;case"phone":a="Phone";break;case"space":a="Spacer",n.find(".powrDrilldownToggle").addClass("disabled");break;case"url":a="URL";break;case"address":a="Address";break;case"step":a="Step "+e.toString(),n.find(".powrDrilldownToggle").addClass("disabled"),1===e&&n.find(".delete, .sort, .duplicate").remove(),e++}n.find(".mediaBar .title").html(truncate(a,"35"));var o=n.find(".mediaBar .on-hover-png"),r="//s3-us-west-1.amazonaws.com/powr/formbuilder-gifs/"+i.type+".png";o.css({backgroundImage:"url("+r+")"}),o.html("");var s=n.find(".mediaBar .on-hover-gif"),l="//s3-us-west-1.amazonaws.com/powr/formbuilder-gifs/"+i.type+".gif";s.css({backgroundImage:"url("+l+")"}),s.html("")}},readFormElements:function(){var e=this,t=[];this.$el.find(".formElements.prototype-element:not(.prototype):not(.options)").each(function(){var i=$(this).formToObject(),n=[];$(this).find(".optionsWrapper").find(".prototype-element:not(.prototype)").each(function(){n.push($(this).formToObject())}),i.options=n.map(function(e){return e.name}),i.prices=n.map(function(e){return e.priceChange}),i.altTags=n.map(function(e){return e.altTag}),delete i[""],"free"==e.model.meta.premium_status&&(i.paragraphHeight="50px"),t.push(i)});var i=[];this.$el.find(".prototype-element.discount:not(.prototype)").each(function(){var e=$(this).formToObject();e.discountType||(e.discountType="flat"),i.push(e)}),this.model.setLocals({discountCode:""}),this.model.attributes[e.formDataKey]=t,this.model.attributes.discounts=i},updateFormElementConditionals:function(){this.model.get(this.paymentRequiredKey)?(this.$el.find("#captchasAccordion").slideUp(),this.$el.find(".whenPayments").slideDown(),this.$el.find("#discountCodeAccordion").show()):(this.$el.find("#captchasAccordion").slideDown(),this.$el.find(".whenPayments").slideUp(),this.$el.find("#discountCodeAccordion").hide()),this.updateConditionalLogic(),this.renderMediaBars()},updateConditionalLogic:function(){for(var e=this.model.get(this.formDataKey),t=0;t<e.length;t++){for(var i=$(this.$el.find(".prototype-element.formElements:not(.prototype)")[t]),n=e[t],a="",o="",r=0;r<t;r++){var s=e[r];if(s.label&&$.inArray(s.type,["checkbox","radio","select"])>-1){var l=n.conditionalElement==s.label?"selected":"";if(a+='<option value="'+inputSafe(s.label)+'" '+l+">"+s.label+"</option>","selected"==l)if("checkbox"==s.type)o+='<option value="true" '+("true"==n.conditionalValue?"selected":null)+">Checked</option>";else for(var d in s.options){var l=n.conditionalValue==s.options[d]?"selected":"";o+='<option value="'+inputSafe(s.options[d])+'" '+l+">"+s.options[d]+"</option>"}}}a.length>0?(a='<option value=""> - Select - </option>'+a,o='<option value=""> - Select - </option>'+o,i.find(".selectConditionalElement").html(a),i.find(".selectConditionalValue").html(o),i.find(".conditionalLogic").show()):i.find(".conditionalLogic").hide()}}},window.formElementsViewModule=function(e,t){this.backboneView=e,this.$el=e.$el,this.model=e.model,this.formDataKey="data",this.paymentRequiredKey="paymentRequired";for(var i in t)this[i]=t[i];this.initialize()},formElementsViewModule.prototype={initialize:function(){var e=this;this.$el.on("click","#submitButton",function(e){setTimeout(function(){$(".validity-alert").each(function(){var e=$(this).siblings("label").text();e="Please complete: "+e,$(this).find(".ws-po-box").text(e)})},250)}),this.$el.on("keydown",".realForm input",function(e){if(13==e.keyCode)return e.preventDefault(),!1}),this.$el.on("change",".addressWrapper [name=country]",function(){var t=$(this).parents(".addressWrapper").find("[name=state]"),i=t.prop("required")?"*":"";i+="US"==$(this).val()?"State":"State / Province",t.attr("placeholder",i),e.backboneView.updateInputFields()}),this.$el.on("click keyup",".radioImage .radioOption",function(e){e.keyCode&&13!=e.keyCode||($(this).parents(".radioImage").find(".radioOption").removeClass("checked"),$(this).addClass("checked"),$(this).find("input").prop("checked",!0).trigger("change"))}),e.$el.on("change",".realForm .select, .realForm .multipleCheckbox, .realForm .radio, .realForm .radioImage",function(){e.calculatePrice()}),e.$el.on("keyup input",".paypalQuantity",function(){e.calculatePrice()}),this.$el.on("keyup",".discountCode",function(){"undefined"!=typeof DISCOUNT_CODE_TIMER&&clearTimeout(DISCOUNT_CODE_TIMER),window.DISCOUNT_CODE_TIMER=setTimeout(function(){e.model.setLocals({discountCode:""}),debug()("Discount code change detected");var t=e.$el.find(".discountCode").val();if(0==t.length)return e.$el.find(".discountCodeStatus").html(""),void e.calculatePrice();for(var i=0;i<e.model.get("discounts").length;i++){if(t==e.model.get("discounts")[i].discountCode)return debug()("Valid code"),e.model.setLocals({discountCode:t}),e.$el.find(".discountCodeStatus").removeClass("fadeIn").html('<i class="success fa fa-check"></i>').addClass("fadeIn"),void e.calculatePrice()}debug()("invalid code!"),e.$el.find(".discountCodeStatus").removeClass("fadeIn").html('<i class="fail fa fa-exclamation-triangle"></i>').addClass("fadeIn"),e.calculatePrice()},500)})},renderFormElements:function(e){e=e||!1;var t=this;this.model.syncLocalData();var i=t.model.get("locals").data,n=[],a=[],o={},r=!0;if(t.model.setLocals({lastStep:r}),t.model.get("multistepForm")){var s=t.model.get("locals").previousStepIdxs||[],l=t.model.get("locals").currentStepIdx||0,d=t.model.get("locals").nextStepIdx;if("previous"===e){l=s.pop(),d=null;var u=l+1}else if("next"===e)var u=d+1;else var u=l+1}else var u=0;var c=0,p=0;if(i[0]&&i[0].isDefault)r=!1;else for(;i[u];){var m=i[u];if("page"==m.type?(n.push({meta:o,content:JSON.parse(JSON.stringify(a))}),a=[],o=m):(0!=m.length&&m.label||("radio"==m.type?(c++,m.radioName="(Radio "+c+")"):(p++,m.labelDefault="(No label "+p+")")),a.push(m)),this.model.get("multistepForm")&&"step"===m.type){r=!1,!e&&d||(s[s.length-1]!==l&&d&&s.push(l),d&&(l=d),d=u),t.model.setLocals({currentStepIdx:l,nextStepIdx:d,previousStepIdxs:s,lastStep:r});break}u++}r?(t.model.setLocals({lastStep:r}),t.model.get("multistepForm")&&d!==i.length&&(s[s.length-1]!==l&&d&&s.push(l),t.model.setLocals({currentStepIdx:d,nextStepIdx:i.length,previousStepIdxs:s})),$("#submitButton").text(t.model.get("buttonText")),t.model.get("paymentRequired")&&t.model.get("showPriceSummary")&&$("#submitButton").text(t.calculatePrice()),$(".discountCodeField").removeClass("hidden"),$(".quantityField").removeClass("hidden"),$(".recaptchaContent").find("input").prop("required",!0),$(".recaptchaContent").removeClass("hidden"),t.backboneView.buildCaptcha()):($("#submitButton").text(t.model.get("nextButtonText")),$(".discountCodeField").addClass("hidden"),$(".recaptchaContent").find("input").prop("required",!1),$(".quantityField").addClass("hidden"),$(".recaptchaContent").addClass("hidden")),s&&s.length?$("#formBackButton").show():this.$el.find("#formBackButton").hide(),a.length>0&&n.push({meta:o||{},content:a}),t.model.setLocals({pages:n}),t.renderPage(0)},isLastPage:function(){return this.model.get("locals").page==this.model.get("locals").pages.length-1},signatureDependences:function(){if(!window.signatureDependencesLoaded){$.ajax({url:"/public-assets/html2canvas.min.js",dataType:"script"}),window.signatureDependencesLoaded=!0}},setupSignatureImage:function(e){var t,i=this,n=$(e),a=$(e).next(".signatureName"),o=this.$el.find(".submitButton");n.on("keyup",function(){clearTimeout(t),n.val().length>0?($(e).keypress(function(e){13==e.keyCode&&e.preventDefault()}),o.attr("disabled",!0),a.show(),a.next(".signatureImage")&&a.next(".signatureImage").remove(),a.text($(e).val()),i.signatureDependences(),t=setTimeout(function(){i.signatureToImage(a)},1e3)):($(e).next(".signatureName").text(""),a.next(".signatureImage")&&a.next(".signatureImage").remove())}),n.on("keydown",".signatureInput",function(){clearTimeout(t)})},signatureToImage:function(e){var t=$(e),i=this.$el.find(".submitButton");html2canvas(t,{useCORS:!0,onrendered:function(e){var n=e.toDataURL("image/png");t.after('<img class="signatureImage" src="'+n+'" />'),t.next(".signatureImage").length&&t.next(".signatureImage").prop("src").length<10&&t.next(".signatureImage").remove(),t.hide(),i.attr("disabled",!1)}})},clearValidationErrors:function(){debug()("Clearing validation errors"),this.$el.find("#validationErrors").hide(),this.$el.find("#uploadErrors").hide(),this.$el.find("#noBusinessErrors").hide(),this.$el.find(".captchaInput").toggleClass("errors",!1),this.$el.find("#spamDetection").hide()},showValidationErrors:function(){debug()("Show validation errors"),this.$el.find("#validationErrors").fadeIn(),this.backboneView.updateInputFields()},showUploadErrors:function(){debug()("Show upload errors"),this.$el.find("#uploadErrors").fadeIn(),this.backboneView.updateInputFields()},dateIsNow:function(e){var t=e.split(", ")[0],i=e.split(", ")[1],n=new Date,a=(n.getMonth()+1).toString()+"/"+n.getDate().toString()+"/"+n.getFullYear().toString(),o=n.getDate().toString()+"/"+(n.getMonth()+1).toString()+"/"+n.getFullYear().toString(),r=n.getMinutes()<10?"0"+n.getMinutes().toString():n.getMinutes().toString(),s=n.getHours()%12+":"+r+(n.getHours()>=12?"PM":"AM"),l=n.getHours()+":"+r;return!(t!==a&&t!==o||i!==s&&i!==l)},elementIsPresent:function(e){var t=this.model.view.$el.find("#"+e.idx.toString());if(!e.conditionalValue)return!0;if(this.elementInCurrentStep(e)&&t[0]&&"none"!==t.css("display"))return!0;var i=this.model.get("locals").data.filter(function(t){return t.label===e.conditionalElement});if(i.length>1)return!1;var n=i[0],a=n.selectedOption===e.conditionalValue;if(n.checked)var o=n.checked.toString()===e.conditionalValue;else var o=!1;return a||o},elementInCurrentStep:function(e){if(!this.model.get("multistepForm"))return!0;if(!this.model.view.$el.find("#"+e.idx.toString())[0])return!1;var t=this.model.get("locals").previousStepIdxs,i=this.model.get("locals").currentStepIdx,n=t[t.length-1];return e.idx>n&&e.idx<i},highlightBlankRequiredFields:function(){var e=this,t=[];if(this.model.get("locals").data)return this.model.get("locals").data.forEach(function(i){var n=e.model.view.$el.find("#"+i.idx.toString());if(!(i.idx>e.model.get("locals").nextStepIdx)&&("email"===i.type||"signature"===i.type||!i.value)&&i.required&&e.elementIsPresent(i)&&!i.selectedOption&&!i.checked&&!i.defaultChecked&&!i.selectedOptions&&!i.country&&(!i.dateTimeHidden||e.dateIsNow(i.dateTimeHidden))&&"none"!==n.css("display")){if("signature"===i.type&&$("#"+i.idx).find("img")[0])return;"email"!==i.type&&(t.push(i),e.$el.find("#"+i.idx+".formElement").find("input, textarea, select, label, button").addClass("requiredAndBlank")),n.find("#"+i.idx.toString()+"_errors").remove(),"email"===i.type?i.value&&-1!=i.value.search("@")||(t.push(i),e.$el.find("#"+i.idx+".formElement").find("input, textarea, select, label, button").addClass("requiredAndBlank"),n.append('<p style="color: red" id="'+i.idx.toString()+'_errors">Please enter a valid email</p>')):n.append('<p style="color: red" id="'+i.idx.toString()+'_errors">Please enter a valid input</p>'),e.$el.find("input.requiredAndBlank, textarea.requiredAndBlank").first().focus()}}),t.length>0},validate:function(){var e=this;e.clearValidationErrors();var t=e.highlightBlankRequiredFields(),i="";if(e.$el.find("input.email").each(function(){if($(this).val().search("@")>-1)return void(i=$(this).val());$(this).hasClass("requiredAndBlank")}),0==i.length&&e.$el.find('input[type="text"]').each(function(){if($(this).val().search("@")>-1)return void(i=$(this).val())}),i.length>0&&deliverHash(i),"function"==typeof e.$el.find(".realForm")[0].checkValidity){if(0==e.$el.find(".realForm")[0].checkValidity())return debug()("Validity is false. Do not submit!"),e.showValidationErrors(),!1}var n=!0;e.$el.find("input.email[required]").each(function(){if(-1==$(this).val().search("@"))return n=!1,!1});var a=!0;e.$el.find(".multipleCheckbox").each(function(){if($(this).hasClass("hiddenRequired")&&0==$(this).find('input[type="checkbox"]:checked').length)return a=!1,!1});var o=!0;if(e.$el.find("input.hiddenRequired").each(function(){if(0==$(this).val().length)return o=!1,!1}),0==n||0==a||0==o)return debug()("Form validity false"),e.showValidationErrors(),!1;var r=!0;if(e.$el.find(".fileURL").each(function(){if($(this).data("currently-uploading"))return r=!1,!1}),0==r)return debug()("Form validity false"),e.showUploadErrors(),!1;var s=!0;if(e.$el.find(".textarea").each(function(){var e=$(this).find("textarea");if(e.data("limiting")&&parseInt(e.data("max"))&&0!=parseInt(e.data("max"))&&parseInt(e.data("max"))<e.val().length)return $(this).find(".lengthErrors").fadeIn(),s=!1,!1}),0==s)return debug()("Form validity false"),!1;if(e.model.get("locals").isDirty){$(".saveModal").modal();var l=e.model.get("data");return"step"===l[l.length-1].type&&(l.pop(),this.model.set({data:l}),this.model.settings.handleMultistepForms()),!1}return e.model.get("paymentRequired")&&0==e.model.get("paypalPaypalAccount").length?(e.$el.find("#noBusinessErrors").show(),!1):e.model.get("locals").isDirty?($(".saveModal").modal("show"),!1):""!=e.$el.find(".honeypot").val()?(e.$el.find("#spamDetection").show(),!1):(new Date).getTime()-e.model.get("locals").loadTime<2100?(e.$el.find("#spamDetection").show(),!1):!t},renderPage:function(e,t){var i=this,n=i.model.get("locals").pages,a=this.model;i.model.setLocals({page:e});var o=t;t=function(){"blockLabels"==i.model.get("labelType")&&i.$el.find("input,textarea").each(function(){$(this).attr("placeholder","")}),o&&o()},this.$el.on("click focus",".signatureInput",function(){i.setupSignatureImage(this)});for(var r=this.$el.find(".dynamicElements"),s=n[e]||{meta:{},content:[]},l="",d=0,u=0;u<s.content.length;u++){var c=JSON.parse(JSON.stringify(s.content[u])),p=$("#formElementTemplate").html();if(c.options){var m=[];for(var h in c.options)c.options.hasOwnProperty(h)&&c.options[h]&&c.options[h].length>0&&m.push({name:c.options[h],price:parseFloat((c.prices||[])[h])||0})}var f=_.template(p)({m:a.attributes,item:$.extend(c,{options:m}),view:i,idx:c.idx});c.half?d++:d=0,3==d&&(d=1,f='<div class="elementWrapper">'+f+"</div>"),l+=f}r.hide().html(l).fadeIn(function(){i.backboneView.postSizeToSocket(),t&&t(),$(this).toggleClass("visible",!0)}),i.$el.find(".textarea").each(function(){var e=$(this);e.find("textarea").on("keyup",function(){e.find(".currentLength").text($(this).val().length.toString()+" out of "+$(this).data("max").toString()+" characters"),$(this).val().length>parseInt($(this).data("max"))?e.find(".lengthErrors").fadeIn():e.find(".lengthErrors").fadeOut()})}),i.updateConditionalElements();var g=i.model.get("title");s.meta.name&&s.meta.name.length>0&&(g=s.meta.name);var v=i.$el.find(".formTitle");0==e?v.text(g):v.text().trim()!=g&&v.fadeOut(function(){v.text(g),v.fadeIn()});i.model.get("buttonText");s.meta.buttonText&&s.meta.buttonText.length>0&&s.meta.buttonText;i.$el.find(".submitButton");if("blockLabels"==this.model.get("labelType")&&this.$el.find('input:not([name="password"]), textarea').attr("placeholder",""),a.get("multistepForm")){var b=a.get("data").filter(function(e){return"step"===e.type}).length,y=a.get("locals").previousStepIdxs.length,w=y/b*100;$("[role='progressbar']").css("width",w.toString()+"%"),$(".progress-bar-percentage").html(parseInt(w).toString()+"%")}if(i.isLastPage()){if(i.model.get("paymentRequired")&&i.model.get("redirectLink").length>0){var S=POWr.paypalRedirectUrl(i.model.get("redirectLink"));i.$el.find(".paypalButton [name=return]").val(S)}$("input").each(function(){$(this)[0].oninvalid=function(e){if(e.target.setCustomValidity(""),!e.target.validity.valid){var t="Please complete: "+$(this).attr("title");e.target.setCustomValidity(t),$(e.target).siblings(".validity-alert").find(".ws-po-box").text(t)}},$(this)[0].oninput=function(e){e.target.setCustomValidity("")}})}if("undefined"!=typeof INITIALIZING_EXTRA_PICKERS&&clearTimeout(INITIALIZING_EXTRA_PICKERS),window.INITIALIZING_EXTRA_PICKERS=setTimeout(function(){void 0!=i.backboneView.initializeDateTimePickers&&i.backboneView.initializeDateTimePickers(),i.initializeFileUploaders(),i.initializeUrlInputs()},1500),i.preventMultipleSubmission()){i.$el.find(".realForm input, .realForm textarea, .realForm select").prop("disabled",!0);var k="You've already submitted a response";i.$el.find("input").attr("title",k),i.$el.find(".submitButton").attr("title",k),i.$el.on("click",function(e){i.$el.find("#alreadySubmittedErrors").slideDown()})}i.ieNumberHotfix(),i.calculatePrice()},updateConditionalElements:function(){var e=this,t=0;this.$el.find(".formElement").each(function(i){var n=$(this),a=e.model.get(e.formDataKey)[$(n).prop("id")];if(a.conditionalElement&&a.conditionalValue){var o=null;e.model.get("locals").data.forEach(function(e){a.conditionalElement===e.label&&(o=e)}),o&&(o.selectedOption===a.conditionalValue||void 0!==o.checked&&o.checked.toString()===a.conditionalValue)?(n.slideDown("fast"),n.find(".rememberRequired").prop("required",!0).prop("disabled",!1),n.find(".rememberHiddenRequired").addBack(".rememberHiddenRequired").toggleClass("hiddenRequired",!0).toggleClass("rememberHiddenRequired",!1)):(n.hide(),n.find("[required]").toggleClass("rememberRequired",!0).prop("required",!1).prop("disabled",!0),n.find(".hiddenRequired").addBack(".hiddenRequired").toggleClass("hiddenRequired",!1).toggleClass("rememberHiddenRequired",!0))}else n.slideDown("fast"),n.find(".rememberRequired").prop("required",!0).prop("disabled",!1),n.find(".rememberHiddenRequired").addBack(".rememberHiddenRequired").toggleClass("hiddenRequired",!0).toggleClass("rememberHiddenRequired",!1);t+=1})},saveData:function(){var e=this;try{localStorage.setItem("Form_"+e.model.meta.id+"_locals",JSON.stringify(e.model.get("locals"))),localStorage.setItem("Form_"+e.model.meta.id+"_timestamp",(new Date).toString())}catch(e){}},currentPageData:function(){var e=this,t=this.$el.find(".realForm"),i=[],n=1,a=t.find('input[type="text"], input[type="date"], input[type="email"], input[type="password"], input[type="hidden"], input[type="number"], textarea, select, .radio, .radioImage, .multipleCheckbox, .checkbox input[type="checkbox"], input.fileURL, input[type="tel"], input[type="url"], input[type="signature"], .addressWrapper'),o="",r=[],s={};a.each(function(){for(var t=["captchaInput","honeypot","dateSelector","timeSelector","ignoreThis"],a=0;a<t.length;a++)if($(this).hasClass(t[a]))return!0;if("none"==$(this).closest(".formElement").css("display"))return!0;if($(this).hasClass("addressWrapper")){var l=$(this).data("is-shipping-address"),d=$(this).formToObject();if(e.model.get("paymentRequired")&&l)state_codes={alabama:"AL",alaska:"AK",arizona:"AZ",arkansas:"AR",california:"CA",colorado:"CO",connecticut:"CT",delaware:"DE","district of columbia":"DC",florida:"FL",georgia:"GA",hawaii:"HI",idaho:"ID",illinois:"IL",indiana:"IN",iowa:"IA",kansas:"KS",kentucky:"KY",louisiana:"LA",maine:"ME",maryland:"MD",massachusetts:"MA",michigan:"MI",minnesota:"MN",mississippi:"MS",missouri:"MO",montana:"MT",nebraska:"NE",nevada:"NV","new hampshire":"NH","new jersey":"NJ","new mexico":"NM","new york":"NY","north carolina":"NC","north dakota":"ND",ohio:"OH",oklahoma:"OK",oregon:"OR",pennsylvania:"PA","rhode island":"RI","south carolina":"SC","south dakota":"SD",tennessee:"TN",texas:"TX",utah:"UT",vermont:"VT",virginia:"VA",washington:"WA","west virginia":"WV",wisconsin:"WI",wyoming:"WY","british columbia":"BC",ontario:"ON","newfoundland and labrador":"NL","nova scotia":"NS","prince edward island":"PE","new brunswick":"NB",quebec:"QC",manitoba:"MB",saskatchewan:"SK",alberta:"AB","northwest territories":"NT",nunavut:"NU","yukon territory":"YT",agrigento:"AG",alessandria:"AL",ancona:"AN",aosta:"AO",arezzo:"AR","ascoli piceno":"AP",asti:"AT",avellino:"AV",bari:"BA",belluno:"BL",benevento:"BN",bergamo:"BG",biella:"BI",bologna:"BO",bolzano:"BZ",brescia:"BS",brindisi:"BR",cagliari:"CA",caltanissetta:"CL",campobasso:"CB",caserta:"CE",catania:"CT",catanzaro:"CZ",chieti:"CH",como:"CO",cosenza:"CS",cremona:"CR",crotone:"KR",cuneo:"CN",enna:"EN",ferrara:"FE",firenze:"FI",foggia:"FG","forli-cesena":"FO",frosinone:"FR",genova:"GE",gorizia:"GO",grosseto:"GR",imperia:"IM",isernia:"IS","la spezia":"SP","l’aquila":"AQ",latina:"LT",lecce:"LE",lecco:"LC",livorno:"LI",lodi:"LO",lucca:"LU",macerata:"MC",mantova:"MN","massa-carrara":"MS",matera:"MT",messina:"ME",milano:"MI",modena:"MO","monza e brianza":"MB",napoli:"NA",novara:"NO",nuoro:"NU",oristano:"OR",padova:"PD",palermo:"PA",parma:"PR",pavia:"PV",perugia:"PG",pesaro:"PS",pescara:"PE",piacenza:"PC",pisa:"PI",pistoia:"PT",pordenone:"PN",potenza:"PZ",prato:"PO",ragusa:"RG",ravenna:"RA","reggio calabria":"RC","reggio emilia":"RE",rieti:"RI",rimini:"RN",roma:"RM",rovigo:"RO",salerno:"SA",sassari:"SS",savona:"SV",siena:"SI",siracusa:"SR",sondrio:"SO",taranto:"TA",teramo:"TE",terni:"TR",torino:"TO",trapani:"TP",trento:"TN",treviso:"TV",trieste:"TS",udine:"UD",varese:"VA",venezia:"VE","verbania-cusio-ossola":"VB",vercelli:"VC",verona:"VR","vibo valentia":"VV",vicenza:"VI",drenthe:"DR",flevoland:"FL",friesland:"FR",gelderland:"GE",groningen:"GR",limburg:"LI","noord-brabant":"NB","noord-holland":"NH",overijssel:"OV",utrecht:"UT",zeeland:"ZE","zuid-holland":"ZH","armed forces americas":"AA","armed forces":"AE","armed forces pacific":"AP","american samoa":"AS",guam:"GU","northern mariana islands":"MP","virgin islands":"VI",viterbo:"VT"},void 0!=state_codes[d.state.toLowerCase()]&&(d.state=state_codes[d.state.toLowerCase()]),e.$el.find(".paypalForm").objectToForm(d);else{var u="";d.address1&&(u+=d.address1+", "),d.address2&&(u+=d.address2+", "),u+=d.city+" "+d.state+" "+d.zip+" "+d.country;var c=$(this).data("label");0==(c||"").length&&(c="(Address "+n+")",n++),Object.prototype.hasOwnProperty.call(s,c)?(s[c]=s[c]+1,c=c+"_"+s[c]):s[c]=0,i.push({type:"address",label:c,value:u})}return!0}var p={},c=$(this).attr("name");0!=(c||"").length||$(this).hasClass("radio")||$(this).hasClass("radioImage")?($(this).hasClass("radio")||$(this).hasClass("radioImage"))&&(c=$(this).find("label").first().html()):(c="(No label "+n+")",n++);var m=($(this).data("export-field")||"").trim();p.exportField=m,Object.prototype.hasOwnProperty.call(s,c)?(s[c]=s[c]+1,c=c+"_"+s[c]):s[c]=0;var h=$(this).val(),f=$(this).attr("type");if("checkbox"==f&&(h=!!$(this).prop("checked")),$(this).hasClass("multipleCheckbox")){var g=[];$(this).find('input[type="checkbox"]:checked').each(function(){g.push($(this).val())}),h=g.join(", ")}if(($(this).hasClass("radio")||$(this).hasClass("radioImage"))&&(h=$(this).find('[type="radio"]:checked').val()),"email"==f&&$(this).data("send-confirmation-email")&&(o=h),"email"==f&&$(this).data("subscribe")&&(debug()("Adding subscribe email"),r.push(h)),p.type=$(this).data("form-type"),"file"==p.type?(p.aws_key=$(this).data("aws-key"),p.upload_id=$(this).data("upload-id")):"datetime"==p.type||"date"==p.type||"time"==p.type?(p.timezone=(new Date).getTimezoneOffset(),p.date_format=$(this).attr("data-format"),p.is_twenty_four=$(this).attr("data-is-twenty-four")):"paypalQuantity"==p.type&&(c=e.model.get("quantityLabel"),h=e.model.get("locals").quantity),p.label=c,p.value=h,"radio"==f&&$(this).prop("required")&&(debug()("Required radio label is "+p.label),p.label=p.label.replace("*","")),debug()("Current data is ",p),"signature"==f){var v=$(this).next(".signatureName").next(".signatureImage").prop("src");v&&(p.value=v)}i.push(p)});var l=e.model.get("locals").page||0;return i=i.map(function(e){return e.page=l,e}),debug()("page data is ",i),{data:i,confirmationEmail:o,subscribeEmail:r.join(","),responseToken:e.model.get("locals").responseToken}},ieNumberHotfix:function(){$('[type="number"]').keydown(function(e){return 38==e.keyCode?($(e.target).val(parseInt($(e.target).val())+1),!1):40==e.keyCode?($(e.target).val(parseInt($(e.target).val())-1),!1):void 0})},calculatePrice:function(){var e=this;if("Recurring"==e.model.get("paypalPurchaseType"))var t=parseFloat(e.model.get("paypalSubscriptionPrice"));else{var t=parseFloat(e.model.get("paypalItemCost"));isNaN(t)&&(t=0)}var i="none",n=0,a=e.model.get("locals").discountCode;if(void 0!=a&&a.length>0)for(var o=0;o<e.model.get("discounts").length;o++){var r=e.model.get("discounts")[o],s=r.discountAmount||0;if(a==r.discountCode){"flat"==r.discountType?(i="flat",n=Math.abs(parseFloat(s))):"rate"==r.discountType&&(i="rate",n=Math.abs(parseFloat(s)/100));break}}var l=[];e.model.get("locals").data.forEach(function(e){$.inArray(e.type,["select","multipleCheckbox","radio","radioimage"])>-1&&l.push(e)}),l.forEach(function(e){if("radio"===e.type||"select"===e.type||"radioimage"===e.type){if(!e.selectedOption)return;var i=e.options.indexOf(e.selectedOption);if(e.prices){var n=parseFloat(e.prices[i]);isNaN(n)||(t+=n)}}else if("multipleCheckbox"===e.type){if(!e.selectedOptions)return;e.selectedOptions.forEach(function(i){var n=e.options.indexOf(i),a=parseFloat(e.prices[n]);isNaN(a)||(t+=a)})}}),"rate"==i&&(t*=1-n),t>0?t=t.toFixed(2):t<0&&(t=0);var d=1;e.model.get("showQuantityInput")&&(d=parseInt(e.$el.find(".paypalQuantity").val())||e.model.get("paypalQuantity")||1);var u=d*t;return"flat"==i&&(u-=n),e.model.setLocals({currentPrice:t,fullPrice:u,quantity:d}),e.model.get("paymentRequired")&&e.model.get("locals").lastStep&&e.model.get("showPriceSummary")&&e.$el.find("#submitButton").text(e.model.get("buttonText")+" "+e.priceToString(u)),d>1?e.$el.find('[name="item_name"]').val(d+" x "+e.model.get("paypalItemName")):e.$el.find('[name="item_name"]').val(e.model.get("paypalItemName")),e.priceToString(u)},priceToString:function(e){var t=this,i={USD:"$",EUR:"€",GBP:"£",JPY:"¥"}[t.model.get("paypalCurrencyCode")]||"";return e<0&&(i="-"+i,e*=-1),i+e.toFixed(2)+(i.length>0?"":" "+t.model.get("paypalCurrencyCode"))},optionPriceToString:function(e){return(e>0?"+":"")+this.priceToString(e)},preventMultipleSubmission:function(){return this.model.get("preventMultiple")&&"blocked"==getCookie("powr_form_"+this.model.meta.id)&&!window.APP_SETTINGS},initializeFileUploaders:function(){var e=this;$(".uploadSuccessful").hide(),$(".uploadFail").hide();var t=!1;if(!/MSIE\s+(7|8|9)/.test(navigator.userAgent)){var i=navigator.userAgent.toLowerCase().match(/Android\s+([\d\.]+)/);if(!_.isEmpty(i)){var n=navigator.userAgent.toLowerCase().match(/Android\s+([\d\.]+)/)[1];parseFloat(n.slice(n.indexOf("Android")+8))<4.4&&(t=!0)}}if(t)return void this.$el.on("click touchstart keyup",".uploadBtn",function(e){if(!e.keyCode||13==e.keyCode){var t=$(this).parents(".fileUploadParent");t.find(".uploadFail").show(),t.find(".uploadIcon").hide(),t.find(".fileInputName").html('<i class="fa fa-warning"></i> Please use a more recent browser to upload file')}});var a=function(){e.$el.find(".fileUploadInput").each(function(t,i){var n=$(i),a=n.parents(".fileUploadParent"),o=a.find('input[type="submit"]'),r=a.find(".progress-bar"),s=a.find(".progressContainer"),l=$(a).find(".fileURL");a.find(".uploadBtn").on("click touchstart keyup",function(e){e.keyCode&&13!=e.keyCode||a.find(".fileUploadInput").trigger("click")}),$(n).on("change",function(e){var t=e.currentTarget.files;if(t&&t[0]&&t[0].size){var i=(t[0].size/1024/1024).toFixed(4);$(this).data("filesize",i)}});var d=JSON.parse(JSON.stringify(e.form_data));d.key=d.key.replace("/${filename}","/"+t+"-${filename}"),n.fileupload({fileInput:n,url:"//"+e.direct_post_url,type:"POST",autoUpload:!1,formData:d,paramName:"file",dataType:"XML",replaceFileInput:!1,progressall:function(e,t){var i=parseInt(t.loaded/t.total*100,10);r.css("width",i+"%"),r.attr("aria-valuenow",i)},add:function(e,t){var i;i="wix"==HOST&&Date.parse(META.created_at)>Date.parse("Mon, 3 July 2017 14:30:00 -0700")?{free:0,premium:5,pro:25,enterprise:100}:{free:0,premium:5,pro:10,enterprise:100};var a=META.premium_status;$(this).attr("filesize")&&(a=$(this).attr("filesize"));var l=i[a];if(n.data("filesize")>l){s.show(),o.prop("disabled",!1),r.css("width","100%"),r.css("background","red").text("File larger than the permitted size!"),n.wrap("<form>").closest("form").get(0).reset(),n.unwrap()}else t.submit()},start:function(e){$(i).trigger("upload_start"),o.prop("disabled",!0),s.show(),r.css("width","0%"),r.css("background","").text(""),a.find(".uploadSuccessful").hide(),a.find(".uploadFail").hide(),l.data("currently-uploading",!0)},done:function(t,n){o.prop("disabled",!1),s.hide(),r.css("width","0%"),r.attr("aria-valuenow","0"),$(".uploadIcon").hide(),debug()("AWS Response: ",n);var d=$(n.jqXHR.responseXML).find("Key").text(),u=$(n.jqXHR.responseXML).find("Location").text();l.val(u),l.data("aws-key",d),l.data("currently-uploading",!1);var c={url:"/app_form_response/upload",data:{filesize:n.total,key:d,id:e.model.meta.id},type:"POST"},p=a.find(".fileUploadInput").val();if(p){var m=p.indexOf("\\")>=0?p.lastIndexOf("\\"):p.lastIndexOf("/"),h=p.substring(m);0!==h.indexOf("\\")&&0!==h.indexOf("/")||(h=h.substring(1)),a.find(".fileInputName").html(h)}ajaxController(c,function(e){e.success?(l.data("upload-id",e.upload_id),$(i).trigger("upload_success"),a.find(".uploadSuccessful").show()):($(i).trigger("upload_fail"),a.find(".uploadFail").show())})},fail:function(e,t){o.prop("disabled",!1),"Uploaded bytes exceed file size"===t.messages.uploadedBytes?r.css("background","red").html("File exceeds file size limit!"):r.css("background","red").text("Failed"),n.wrap("<form>").closest("form").get(0).reset(),n.unwrap()}})})};if(!e.direct_post_url&&e.$el.find(".fileUploadInput").length>0){var o={url:"/form_uploader.json",type:"get",data:{app_id:e.model.meta.id}};ajaxController(o,function(t){t.success&&(e.direct_post_url=t.direct_post_url,e.form_data=t.form_data,a())})}else a()},initializeUrlInputs:function(){this.$el.find('input[type="url"]').each(function(){$(this).blur(function(){var e=$(this),t=e.val();t&&!t.match(/^http([s]?):\/\/.*/)&&e.val("http://"+t)})})},numberHack:function(e){return/^[0-9]/.test(e)?"*"+e:e}}},27:function(e,t){window.PowrRegister=function(e){$.extend(this,e);var t=[{_tag:"pwr-mod-attr",behavior:function(e,t){var i="$"+e;i in this?this.newElem=this[i].add(t):this[i]=t}},{_tag:"pwr-handler",behavior:function(e,t){var i=t.attr("pwr-handler-event");i&&i.length?i.split(",").forEach(function(i){t.on(i,this._exec_handler(e))}.bind(this)):t.on("click",this._exec_handler(e))}},{_tag:"pwr-event",behavior:function(e,t){this._events||PowrEvents.call(this),this.trigger(e)}}],i=function(e,i,n){t.forEach(function(t,n,a){var o=t.behavior,r=e.attr(t._tag);r&&o.call(i,r,e)})};if(!this.$body&&this._html?this.$body=$(this._html):this.$body||(this.$body=$($("[pwr-mod-name="+this.ModuleName+"]").html())),!this.$body.length)return console.warn("Could not find template for POWr Module: [ "+this.ModuleName+" ]");this.length=this.$body.length,this.splice=this.$body.splice.bind(this.$body),this[0]=this.$body.get(0),this._exec_handler=this._exec_handler||function(e){var t=this;return function(i){t._handlers&&t._handlers[e](i,this,t)}}.bind(this),this.register=this.register||function(e){var t,n=this;t=(e||this.$body).findAndSelf("[pwr]"),t.each(function(e){var t=$(this);i(t,n)})},this.register(),this.registerChild=function(e){}}},31:function(e,t){window.POWrDatePickerComponent=function(e){if(PowrStrap.call(this,e),this.formatString=this.formatString||"MM-DD-YYYY",this.using_native_inputs)return this.handleNativeInputs(e);if(this.$datePickerContainer.length){this.$datePickerContainer.datepicker({showOn:"focus",showButtonPanel:!0,dateFormat:"mm-dd-yy",onSelect:this._exec_handler("jqueryCalChange").bind(this)}).on("click",function(){$(this).datepicker("show")});var t=$(document);this.$datePickerContainer.on("keydown",function(e){t.bind("mousemove.datepickertrigger",function(e){t.unbind("mousemove.datepickertrigger"),this._handlers.jqueryCalChange(null,null,this)}.bind(this))}.bind(this))}this.dateState=this.initial_date||null,this.setDateInput()},POWrDatePickerComponent.prototype={ModuleName:"POWrDatePickerComponent",handleNativeInputs:function(e){var t=$(this).find('[type="date"]'),i=$(this).find('[pwr-mod-attr="dateTimeHidden"]');t.on("change",function(e){var t=$(e.target).val(),n=t.split("-"),a=n[0],o=n[1]-1,r=n[2];this.dateState.year(a),this.dateState.month(o),this.dateState.date(r),i.val((o+1).toString()+"/"+r+"/"+a)}.bind(this))},setDateState:function(e){this.dateState=e?moment_custom(e):moment_custom(),this.setDateInput()},setFormat:function(e){if(!e)throw"You messed up here";this.formatString=e,this.setDateInput();var t="MM-DD-YYYY"===this.formatString?"mm-dd-yy":"dd-mm-yy";this.$datePickerContainer.datepicker("option","dateFormat",t),this.setDateInput()},setDateInput:function(){this.dateState||this.setDateState();var e=this.dateState.format(this.formatString,this.use_local);this.$datePickerContainer.datepicker("option","dateFormat","MM-DD-YYYY"===this.formatString?"mm-dd-yy":"dd-mm-yy"),this.$datePickerContainer.datepicker("setDate",e)},_setYear:function(e){this.dateState.year(e)},_setMonth:function(e){this.dateState.month(e)},_setDay:function(e){this.dateState.date(e)},_changeDate:function(e){var t=moment_custom(e),i={year:t.get("year"),month:t.get("month"),date:t.get("date"),hour:t.get("hour"),minute:t.get("minute"),second:t.get("second"),millisecond:t.get("millisecond")};this.dateState=moment_custom(i),this.setDateInput()},_handlers:{jqueryCalChange:function(e,t,i){var n=i.$datePickerContainer.datepicker("getDate");i._setMonth(n.getUTCMonth()),i._setDay(n.getUTCDate()),i.setDateState(n),i.trigger("change")}},_html:function(){return['<input type="text" class="form-control ignore user-success" pwr pwr-mod-attr="datePickerContainer">'].join("\n")}()}},32:function(e,t){window.PowrEvents=function(){this._events={},this.on=function(e,t){return e in this._events?this._events[e].push(t):this._events[e]=[t],this},this.trigger=function(e){return e in this._events?this._events[e].forEach(function(t){t(this,e)}.bind(this)):console.warn("Unregistered event [ "+e+" ] called. For POWr Module: [ "+this.moduleName+" ]"),this},this.triggerFor=function(e,t){return function(i){t&&t.call(this,e,i),this.trigger(e)}.bind(this)}}},33:function(e,t){window.PowrStrap=function(e){this.registeredModules=[PowrRegister,PowrEvents,PowrHideShow],this._register=function(e){this.registeredModules.push(e),this._make()},this._make=function(){this.registeredModules.forEach(function(t){t.call(this,e)}.bind(this))},this._make()}},34:function(e,t){window.POWrTimePickerComponent=function(e){if(PowrStrap.call(this,e),this.using_native_inputs)return this.handleNativeInputs();this.setTimeState(this.timeState)},POWrTimePickerComponent.prototype={ModuleName:"POWrTimePickerComponent",handleNativeInputs:function(){this.$body.findAndSelf('[type="time"]').on("change",function(e){var t=$(e.target).val(),i=t.split(":"),n=i[0],a=i[1];this.timeState.hour(n,this.use_local),this.timeState.minute(a,this.use_local),this.trigger("change")}.bind(this)),this.timeState=moment_custom()},disable:function(){this.$minuteInput.attr("disabled","disabled"),this.$hourInput.attr("disabled","disabled"),this.$amPmInput.attr("disabled","disabled")},enable:function(){this.$minuteInput.removeAttr("disabled"),this.$hourInput.removeAttr("disabled"),this.$amPmInput.removeAttr("disabled")},setTimeState:function(e){return this.timeState=moment_custom(e||moment_custom()),this._setInputs(),this},_setInputs:function(){this._setHourInput(),this._setMinuteInput(),this._setAMPMInput()},_setHourInput:function(){var e=this.timeState.hours(null,this.use_local),t=this.is_twentyfour();if(e>12)var e=t?e:e-12;0!==e||t||(e=12),this.$hourInput.val(this.pad2(e))},_setMinuteInput:function(){var e=this.timeState.minutes(null,this.use_local);this.$minuteInput.val(this.pad2(e))},_setAMPMInput:function(){var e=this.timeState.format("A",this.use_local);this.$amPmInput.val(this.pad2(e))},_alternateAMPM:function(){var e=this.timeState.format("A",this.use_local),t="PM"===e?-12:12;this.timeState.add(t,"hours"),this._setAMPMInput()},_incrementHour:function(){var e=this.timeState.hours(null,this.use_local);e===(this.is_twentyfour()?23:12)?this.timeState.hours(1,this.use_local):this.timeState.hours(e+1,this.use_local),this._setHourInput(),this.trigger("change")},_decrementHour:function(){var e=this.timeState.hours(null,this.use_local);0===e?this.timeState.hours(23,this.use_local):this.timeState.hours(e+-1,this.use_local),this._setHourInput(),this.trigger("change")},_incrementMinute:function(){var e=this.timeState.minutes(null,this.use_local);59===e?this.timeState.minutes(0):this.timeState.minutes(e+1),this._setMinuteInput(),this.trigger("change")},_decrementMinute:function(){0===this.timeState.minutes(null,this.use_local)?this.timeState.minutes(59,this.use_local):this.timeState.minutes(this.timeState.minutes(null,this.use_local)+-1,this.use_local),this._setMinuteInput(),this.trigger("change")},hourInputValidate:function(e){var t=parseInt(e);if(isNaN(t))return e;var i;return numberRegex.test(t)?t>12&&(i=12):i=1,i},minuteInputValidate:function(e){var t=parseInt(e);if(isNaN(t))return e;return numberRegex.test(t)?t>59?59:this.pad2(t):"00"},amPmInputValidate:function(e){var t=e.toUpperCase();return"PM"!=t&&"AM"!=t&&(t="PM"),t},keydownMinuteInput:function(e){return 38==e.keyCode?(this._incrementMinute(),!0):40==e.keyCode?(this._decrementMinute(),!0):void 0},keydownHourInput:function(e){return 38==e.keyCode?(this._incrementHour(),!0):40==e.keyCode?(this._decrementHour(),!0):void 0},keydownAmPmInput:function(e){if(38==e.keyCode||40==e.keyCode)return this._alternateAMPM(),!0},_exec_handler:function(e){var t=this;return function(i){t._handlers[e](i,this,t),t.trigger("change")}},_handlers:{hourInputKeyBlur:function(e,t,i){if(!i.keydownHourInput(e)){var n=parseInt($(t).val());isNaN(n);isNaN(parseInt(n))||i.timeState.hour(n,i.use_local),i._setInputs()}},minuteInputKeyBlur:function(e,t,i){if(!i.keydownMinuteInput(e)){var n=$(t),a=parseInt(n.val()),o=!isNaN(a),r=a<=60;o&&r&&i.timeState.minute(a,i.use_local),i._setInputs()}},amPmInputKeyBlur:function(e,t,i){if(!i.keydownAmPmInput(e)){var n=$(t),a=i.amPmInputValidate(n.val()),o=i.timeState.format("A");if(a!==o){var r="PM"===o?-12:12;i.timeState.add(r,"hours"),i._setInputs()}}},incrementHourClick:function(e,t,i){i._incrementHour()},decrementHourClick:function(e,t,i){i._decrementHour()},incrementMinuteClick:function(e,t,i){i._incrementMinute()},decrementMinuteClick:function(e,t,i){i._decrementMinute()},ampPmToggleClick:function(e,t,i){i._alternateAMPM()}},_initializers:{$timeSelectorEl:function(e){var t=e.$timeSelectorEl,i=new Date,n=i.getHours()+":"+i.getMinutes(),a=[{label:"0:00 (12 am)",value:0},{label:"1:00 (1 am)",value:1},{label:"2:00 (2 am)",value:2},{label:"3:00 (3 am)",value:3},{label:"4:00 (4 am)",value:4},{label:"5:00 (5 am)",value:5},{label:"6:00 (6 am)",value:6},{label:"7:00 (7 am)",value:7},{label:"8:00 (8 am)",value:8},{label:"9:00 (9 am)",value:9},{label:"10:00 (10 am)",value:10},{label:"11:00 (11 am)",value:11},{label:"12:00 (12 pm)",value:12},{label:"13:00 (1 pm)",value:13},{label:"14:00 (2 pm)",value:14},{label:"15:00 (3 pm)",value:15},{label:"16:00 (4 pm)",value:16},{label:"17:00 (5 pm)",value:17},{label:"18:00 (6 pm)",value:18},{label:"19:00 (7 pm)",value:19},{label:"20:00 (8 pm)",value:20},{label:"21:00 (9 pm)",value:21},{label:"22:00 (10 pm)",value:22},{label:"23:00 (11 pm)",value:23},{label:"24:00 (12 pm)",value:24}];t.autocomplete({appendTo:self.$el,source:a,minLength:0,change:function(){e.__updateDatetime()}}),t.focus(function(){$(this).autocomplete("search","")}),t.on("click",function(){$(this).autocomplete("search","")}),t.val(n)}},is_twentyfour:function(){return!!this.$amPmInput.attr("data-istwentyfour")},execInitializer:function(e,t){this._initializers[e](t)},pad2:function(e){return e.length>1&&e<10?e:(e<10?"0":"")+e},_html:function(){return['<div class="timePicker" pwr pwr-mod-attr="timepickers">','<div class="hourPicker">','<div class="upHour timeArrow" unselectable="on" pwr pwr-mod-attr="incrementHour" pwr-handler="incrementHourClick"><i class="fa fa-caret-up"></i></div>','<input type="text" class="hour ignoreThis" value="1" pwr pwr-mod-attr="hourInput" pwr-handler-event="blur" pwr-handler="hourInputKeyBlur">','<div class="downHour timeArrow" unselectable="on" pwr pwr-mod-attr="decrementHour" pwr-handler="decrementHourClick"><i class="fa fa-caret-down"></i></div>',"</div>",'<div class="colon">:</div>','<div class="minutePicker">','<div class="upMinute timeArrow" unselectable="on" pwr pwr-mod-attr="incrementMinute" pwr-handler="incrementMinuteClick"><i class="fa fa-caret-up"></i></div>','<input type="text" class="minute ignoreThis" value="00" pwr pwr-mod-attr="minuteInput" pwr-handler-event="blur" pwr-handler="minuteInputKeyBlur">','<div class="downMinute timeArrow" unselectable="on" pwr pwr-mod-attr="decrementMinute" pwr-handler="decrementMinuteClick"><i class="fa fa-caret-down"></i></div>',"</div>",'<div class="ampmPicker" pwr pwr-mod-attr="ampmPickerContainer">','<div class="upAmpm timeArrow" unselectable="on" pwr pwr-mod-attr="ampmToggle" pwr-handler="ampPmToggleClick"><i class="fa fa-caret-up"></i></div>','<input type="text" class="ampm ignoreThis" pwr pwr-mod-attr="amPmInput" pwr-handler-event="blur" pwr-handler="amPmInputKeyBlur">','<div class="downAmpm timeArrow" unselectable="on" pwr pwr-mod-attr="ampmToggle" pwr-handler="ampPmToggleClick"><i class="fa fa-caret-down"></i></div>',"</div>","</div>"].join("\n")}()}},4:function(e,t){!function(t,i,n,a,o,r){function s(e,t){var i=typeof e[t];return"function"==i||!("object"!=i||!e[t])||"unknown"==i}function l(e,t){return!("object"!=typeof e[t]||!e[t])}function d(e){return"[object Array]"===Object.prototype.toString.call(e)}function u(){var e="Shockwave Flash",t="application/x-shockwave-flash";if(!_(navigator.plugins)&&"object"==typeof navigator.plugins[e]){var i=navigator.plugins[e].description;i&&!_(navigator.mimeTypes)&&navigator.mimeTypes[t]&&navigator.mimeTypes[t].enabledPlugin&&(I=i.match(/\d+/g))}if(!I){var n;try{n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),I=Array.prototype.slice.call(n.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1),n=null}catch(e){}}if(!I)return!1;var a=parseInt(I[0],10),o=parseInt(I[1],10);return A=a>9&&o>0,!0}function c(){if(!z){z=!0;for(var e=0;e<q.length;e++)q[e]();q.length=0}}function p(e,t){if(z)return void e.call(t);q.push(function(){e.call(t)})}function m(){var e=parent;if(""!==L)for(var t=0,i=L.split(".");t<i.length;t++)e=e[i[t]];return e.easyXDM}function h(e){return t.easyXDM=U,L=e,L&&(V="easyXDM_"+L.replace(".","_")+"_"),B}function f(e){return e.match(R)[3]}function g(e){return e.match(R)[4]||""}function v(e){var t=e.toLowerCase().match(R),i=t[2],n=t[3],a=t[4]||"";return("http:"==i&&":80"==a||"https:"==i&&":443"==a)&&(a=""),i+"//"+n+a}function b(e){if(e=e.replace(N,"$1/"),!e.match(/^(http||https):\/\//)){var t="/"===e.substring(0,1)?"":n.pathname;"/"!==t.substring(t.length-1)&&(t=t.substring(0,t.lastIndexOf("/")+1)),e=n.protocol+"//"+n.host+t+e}for(;H.test(e);)e=e.replace(H,"");return e}function y(e,t){var i="",n=e.indexOf("#");-1!==n&&(i=e.substring(n),e=e.substring(0,n));var a=[];for(var o in t)t.hasOwnProperty(o)&&a.push(o+"="+r(t[o]));return e+(W?"#":-1==e.indexOf("?")?"?":"&")+a.join("&")+i}function _(e){return void 0===e}function w(e,t,i){var n;for(var a in t)t.hasOwnProperty(a)&&(a in e?(n=t[a],"object"==typeof n?w(e[a],n,i):i||(e[a]=t[a])):e[a]=t[a]);return e}function S(){var e=i.body.appendChild(i.createElement("form")),t=e.appendChild(i.createElement("input"));t.name=V+"TEST"+O,C=t!==e.elements[t.name],i.body.removeChild(e)}function k(e){_(C)&&S();var t;C?t=i.createElement('<iframe name="'+e.props.name+'"/>'):(t=i.createElement("IFRAME"),t.name=e.props.name),t.id=t.name=e.props.name,delete e.props.name,"string"==typeof e.container&&(e.container=i.getElementById(e.container)),e.container||(w(t.style,{position:"absolute",top:"-2000px",left:"0px"}),e.container=i.body);var n=e.props.src;if(e.props.src="javascript:false",w(t,e.props),t.border=t.frameBorder=0,t.allowTransparency=!0,e.container.appendChild(t),e.onLoad&&M(t,"load",e.onLoad),e.usePost){var a,o=e.container.appendChild(i.createElement("form"));if(o.target=t.name,o.action=n,o.method="POST","object"==typeof e.usePost)for(var r in e.usePost)e.usePost.hasOwnProperty(r)&&(C?a=i.createElement('<input name="'+r+'"/>'):(a=i.createElement("INPUT"),a.name=r),a.value=e.usePost[r],o.appendChild(a));o.submit(),o.parentNode.removeChild(o)}else t.src=n;return e.props.src=n,t}function $(e,t){"string"==typeof e&&(e=[e]);for(var i,n=e.length;n--;)if(i=e[n],i=new RegExp("^"==i.substr(0,1)?i:"^"+i.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),i.test(t))return!0;return!1}function E(e){var a,o=e.protocol;if(e.isHost=e.isHost||_(J.xdm_p),W=e.hash||!1,e.props||(e.props={}),e.isHost)e.remote=b(e.remote),e.channel=e.channel||"default"+O++,e.secret=Math.random().toString(16).substring(2),_(o)&&(o=v(n.href)==v(e.remote)?"4":s(t,"postMessage")||s(i,"postMessage")?"1":e.swf&&s(t,"ActiveXObject")&&u()?"6":"Gecko"===navigator.product&&"frameElement"in t&&-1==navigator.userAgent.indexOf("WebKit")?"5":e.remoteHelper?"2":"0");else if(e.channel=J.xdm_c.replace(/["'<>\\]/g,""),e.secret=J.xdm_s,e.remote=J.xdm_e.replace(/["'<>\\]/g,""),o=J.xdm_p,e.acl&&!$(e.acl,e.remote))throw new Error("Access denied for "+e.remote);switch(e.protocol=o,o){case"0":if(w(e,{interval:100,delay:2e3,useResize:!0,useParent:!1,usePolling:!1},!0),e.isHost){if(!e.local){for(var r,l=n.protocol+"//"+n.host,d=i.body.getElementsByTagName("img"),c=d.length;c--;)if(r=d[c],r.src.substring(0,l.length)===l){e.local=r.src;break}e.local||(e.local=t)}var p={xdm_c:e.channel,xdm_p:0};e.local===t?(e.usePolling=!0,e.useParent=!0,e.local=n.protocol+"//"+n.host+n.pathname+n.search,p.xdm_e=e.local,p.xdm_pa=1):p.xdm_e=b(e.local),e.container&&(e.useResize=!1,p.xdm_po=1),e.remote=y(e.remote,p)}else w(e,{channel:J.xdm_c,remote:J.xdm_e,useParent:!_(J.xdm_pa),usePolling:!_(J.xdm_po),useResize:!e.useParent&&e.useResize});a=[new B.stack.HashTransport(e),new B.stack.ReliableBehavior({}),new B.stack.QueueBehavior({encode:!0,maxLength:4e3-e.remote.length}),new B.stack.VerifyBehavior({initiate:e.isHost})];break;case"1":a=[new B.stack.PostMessageTransport(e)];break;case"2":e.isHost&&(e.remoteHelper=b(e.remoteHelper)),a=[new B.stack.NameTransport(e),new B.stack.QueueBehavior,new B.stack.VerifyBehavior({initiate:e.isHost})];break;case"3":a=[new B.stack.NixTransport(e)];break;case"4":a=[new B.stack.SameOriginTransport(e)];break;case"5":a=[new B.stack.FrameElementTransport(e)];break;case"6":I||u(),a=[new B.stack.FlashTransport(e)]}return a.push(new B.stack.QueueBehavior({lazy:e.lazy,remove:!0})),a}function x(e){for(var t,i={incoming:function(e,t){this.up.incoming(e,t)},outgoing:function(e,t){this.down.outgoing(e,t)},callback:function(e){this.up.callback(e)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}},n=0,a=e.length;n<a;n++)t=e[n],w(t,i,!0),0!==n&&(t.down=e[n-1]),n!==a-1&&(t.up=e[n+1]);return t}function T(e){e.up.down=e.down,e.down.up=e.up,e.up=e.down=null}var C,I,A,M,P,D=this,O=Math.floor(1e4*Math.random()),F=Function.prototype,R=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,H=/[\-\w]+\/\.\.\//,N=/([^:])\/\//g,L="",B={},U=t.easyXDM,V="easyXDM_",W=!1;if(s(t,"addEventListener"))M=function(e,t,i){e.addEventListener(t,i,!1)},P=function(e,t,i){e.removeEventListener(t,i,!1)};else{if(!s(t,"attachEvent"))throw new Error("Browser not supported");M=function(e,t,i){e.attachEvent("on"+t,i)},P=function(e,t,i){e.detachEvent("on"+t,i)}}var j,z=!1,q=[];if("readyState"in i?(j=i.readyState,z="complete"==j||~navigator.userAgent.indexOf("AppleWebKit/")&&("loaded"==j||"interactive"==j)):z=!!i.body,!z){if(s(t,"addEventListener"))M(i,"DOMContentLoaded",c);else if(M(i,"readystatechange",function(){"complete"==i.readyState&&c()}),i.documentElement.doScroll&&t===top){var X=function(){if(!z){try{i.documentElement.doScroll("left")}catch(e){return void a(X,1)}c()}};X()}M(t,"load",c)}var J=function(e){e=e.substring(1).split("&");for(var t,i={},n=e.length;n--;)t=e[n].split("="),i[t[0]]=o(t[1]);return i}(/xdm_e=/.test(n.search)?n.search:n.hash),K=function(){var e={},t={a:[1,2,3]},i='{"a":[1,2,3]}';return"undefined"!=typeof JSON&&"function"==typeof JSON.stringify&&JSON.stringify(t).replace(/\s/g,"")===i?JSON:(Object.toJSON&&Object.toJSON(t).replace(/\s/g,"")===i&&(e.stringify=Object.toJSON),"function"==typeof String.prototype.evalJSON&&(t=i.evalJSON(),t.a&&3===t.a.length&&3===t.a[2]&&(e.parse=function(e){return e.evalJSON()})),e.stringify&&e.parse?(K=function(){return e},e):null)};w(B,{version:"2.4.19",query:J,stack:{},apply:w,getJSONObject:K,whenReady:p,noConflict:h}),B.DomHelper={on:M,un:P,requiresJSON:function(e){l(t,"JSON")||i.write('<script type="text/javascript" src="'+e+'"><\/script>')}},function(){var e={};B.Fn={set:function(t,i){e[t]=i},get:function(t,i){if(e.hasOwnProperty(t)){var n=e[t];return i&&delete e[t],n}}}}(),B.Socket=function(e){var t=x(E(e).concat([{incoming:function(t,i){e.onMessage(t,i)},callback:function(t){e.onReady&&e.onReady(t)}}])),i=v(e.remote);this.origin=v(e.remote),this.destroy=function(){t.destroy()},this.postMessage=function(e){t.outgoing(e,i)},t.init()},B.Rpc=function(e,t){if(t.local)for(var i in t.local)if(t.local.hasOwnProperty(i)){var n=t.local[i];"function"==typeof n&&(t.local[i]={method:n})}var a=x(E(e).concat([new B.stack.RpcBehavior(this,t),{callback:function(t){e.onReady&&e.onReady(t)}}]));this.origin=v(e.remote),this.destroy=function(){a.destroy()},a.init()},B.stack.SameOriginTransport=function(e){var t,i,o,r;return t={outgoing:function(e,t,i){o(e),i&&i()},destroy:function(){i&&(i.parentNode.removeChild(i),i=null)},onDOMReady:function(){r=v(e.remote),e.isHost?(w(e.props,{src:y(e.remote,{xdm_e:n.protocol+"//"+n.host+n.pathname,xdm_c:e.channel,xdm_p:4}),name:V+e.channel+"_provider"}),i=k(e),B.Fn.set(e.channel,function(e){return o=e,a(function(){t.up.callback(!0)},0),function(e){t.up.incoming(e,r)}})):(o=m().Fn.get(e.channel,!0)(function(e){t.up.incoming(e,r)}),a(function(){t.up.callback(!0)},0))},init:function(){p(t.onDOMReady,t)}}},B.stack.FlashTransport=function(e){function t(e,t){a(function(){s.up.incoming(e,d)},0)}function o(t){var n=e.swf+"?host="+e.isHost,a="easyXDM_swf_"+Math.floor(1e4*Math.random());B.Fn.set("flash_loaded"+t.replace(/[\-.]/g,"_"),function(){B.stack.FlashTransport[t].swf=u=c.firstChild;for(var e=B.stack.FlashTransport[t].queue,i=0;i<e.length;i++)e[i]();e.length=0}),e.swfContainer?c="string"==typeof e.swfContainer?i.getElementById(e.swfContainer):e.swfContainer:(c=i.createElement("div"),w(c.style,A&&e.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0}),i.body.appendChild(c));var o="callback=flash_loaded"+r(t.replace(/[\-.]/g,"_"))+"&proto="+D.location.protocol+"&domain="+r(f(D.location.href))+"&port="+r(g(D.location.href))+"&ns="+r(L);c.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+a+"' data='"+n+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+n+"'></param><param name='flashvars' value='"+o+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+o+"' allowScriptAccess='always' wmode='transparent' src='"+n+"' height='1' width='1'></embed></object>"}var s,l,d,u,c;return s={outgoing:function(t,i,n){u.postMessage(e.channel,t.toString()),n&&n()},destroy:function(){try{u.destroyChannel(e.channel)}catch(e){}u=null,l&&(l.parentNode.removeChild(l),l=null)},onDOMReady:function(){d=e.remote,B.Fn.set("flash_"+e.channel+"_init",function(){a(function(){s.up.callback(!0)})}),B.Fn.set("flash_"+e.channel+"_onMessage",t),e.swf=b(e.swf);var i=f(e.swf),r=function(){B.stack.FlashTransport[i].init=!0,u=B.stack.FlashTransport[i].swf,u.createChannel(e.channel,e.secret,v(e.remote),e.isHost),e.isHost&&(A&&e.swfNoThrottle&&w(e.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"}),w(e.props,{src:y(e.remote,{xdm_e:v(n.href),xdm_c:e.channel,xdm_p:6,xdm_s:e.secret}),name:V+e.channel+"_provider"}),l=k(e))};B.stack.FlashTransport[i]&&B.stack.FlashTransport[i].init?r():B.stack.FlashTransport[i]?B.stack.FlashTransport[i].queue.push(r):(B.stack.FlashTransport[i]={queue:[r]},o(i))},init:function(){p(s.onDOMReady,s)}}},B.stack.PostMessageTransport=function(e){function i(e){if(e.origin)return v(e.origin);if(e.uri)return v(e.uri);if(e.domain)return n.protocol+"//"+e.domain;throw"Unable to retrieve the origin of the event"}function o(t){var n=i(t);n==d&&t.data.substring(0,e.channel.length+1)==e.channel+" "&&r.up.incoming(t.data.substring(e.channel.length+1),n)}var r,s,l,d;return r={outgoing:function(t,i,n){l.postMessage(e.channel+" "+t,i||d),n&&n()},destroy:function(){P(t,"message",o),s&&(l=null,s.parentNode.removeChild(s),s=null)},onDOMReady:function(){if(d=v(e.remote),e.isHost){var i=function(n){n.data==e.channel+"-ready"&&(l="postMessage"in s.contentWindow?s.contentWindow:s.contentWindow.document,P(t,"message",i),M(t,"message",o),a(function(){r.up.callback(!0)},0))};M(t,"message",i),w(e.props,{src:y(e.remote,{xdm_e:v(n.href),xdm_c:e.channel,xdm_p:1}),name:V+e.channel+"_provider"}),s=k(e)}else M(t,"message",o),l="postMessage"in t.parent?t.parent:t.parent.document,l.postMessage(e.channel+"-ready",d),a(function(){r.up.callback(!0)},0)},init:function(){p(r.onDOMReady,r)}}},B.stack.FrameElementTransport=function(e){var o,r,s,l;return o={outgoing:function(e,t,i){s.call(this,e),i&&i()},destroy:function(){r&&(r.parentNode.removeChild(r),r=null)},onDOMReady:function(){l=v(e.remote),e.isHost?(w(e.props,{src:y(e.remote,{xdm_e:v(n.href),xdm_c:e.channel,xdm_p:5}),name:V+e.channel+"_provider"}),r=k(e),r.fn=function(e){return delete r.fn,s=e,a(function(){o.up.callback(!0)},0),function(e){o.up.incoming(e,l)}}):(i.referrer&&v(i.referrer)!=J.xdm_e&&(t.top.location=J.xdm_e),s=t.frameElement.fn(function(e){o.up.incoming(e,l)}),o.up.callback(!0))},init:function(){p(o.onDOMReady,o)}}},B.stack.NameTransport=function(e){function t(t){var i=e.remoteHelper+(s?"#_3":"#_2")+e.channel;l.contentWindow.sendMessage(t,i)}function i(){s?2!=++u&&s||r.up.callback(!0):(t("ready"),r.up.callback(!0))}function n(e){r.up.incoming(e,m)}function o(){c&&a(function(){c(!0)},0)}var r,s,l,d,u,c,m,h;return r={outgoing:function(e,i,n){c=n,t(e)},destroy:function(){l.parentNode.removeChild(l),l=null,s&&(d.parentNode.removeChild(d),d=null)},onDOMReady:function(){s=e.isHost,u=0,m=v(e.remote),e.local=b(e.local),s?(B.Fn.set(e.channel,function(t){s&&"ready"===t&&(B.Fn.set(e.channel,n),i())}),h=y(e.remote,{xdm_e:e.local,xdm_c:e.channel,xdm_p:2}),w(e.props,{src:h+"#"+e.channel,name:V+e.channel+"_provider"}),d=k(e)):(e.remoteHelper=e.remote,B.Fn.set(e.channel,n));var t=function(){var n=l||this;P(n,"load",t),B.Fn.set(e.channel+"_load",o),function e(){"function"==typeof n.contentWindow.sendMessage?i():a(e,50)}()};l=k({props:{src:e.local+"#_4"+e.channel},onLoad:t})},init:function(){p(r.onDOMReady,r)}}},B.stack.HashTransport=function(e){function i(t){if(f){var i=e.remote+"#"+m+++"_"+t;(l||!g?f.contentWindow:f).location=i}}function n(e){c=e,s.up.incoming(c.substring(c.indexOf("_")+1),b)}function o(){if(h){var e=h.location.href,t="",i=e.indexOf("#");-1!=i&&(t=e.substring(i)),t&&t!=c&&n(t)}}function r(){d=setInterval(o,u)}var s,l,d,u,c,m,h,f,g,b;return s={outgoing:function(e,t){i(e)},destroy:function(){t.clearInterval(d),!l&&g||f.parentNode.removeChild(f),f=null},onDOMReady:function(){if(l=e.isHost,u=e.interval,c="#"+e.channel,m=0,g=e.useParent,b=v(e.remote),l){if(w(e.props,{src:e.remote,name:V+e.channel+"_provider"}),g)e.onLoad=function(){h=t,r(),s.up.callback(!0)};else{var i=0,n=e.delay/50;!function t(){if(++i>n)throw new Error("Unable to reference listenerwindow");try{h=f.contentWindow.frames[V+e.channel+"_consumer"]}catch(e){}h?(r(),s.up.callback(!0)):a(t,50)}()}f=k(e)}else h=t,r(),g?(f=parent,s.up.callback(!0)):(w(e,{props:{src:e.remote+"#"+e.channel+new Date,name:V+e.channel+"_consumer"},onLoad:function(){s.up.callback(!0)}}),f=k(e))},init:function(){p(s.onDOMReady,s)}}},B.stack.ReliableBehavior=function(e){var t,i,n=0,a=0,o="";return t={incoming:function(e,r){var s=e.indexOf("_"),l=e.substring(0,s).split(",");e=e.substring(s+1),l[0]==n&&(o="",i&&i(!0)),e.length>0&&(t.down.outgoing(l[1]+","+n+"_"+o,r),a!=l[1]&&(a=l[1],t.up.incoming(e,r)))},outgoing:function(e,r,s){o=e,i=s,t.down.outgoing(a+","+ ++n+"_"+e,r)}}},B.stack.QueueBehavior=function(e){function t(){if(e.remove&&0===s.length)return void T(i);if(!l&&0!==s.length&&!n){l=!0;var o=s.shift();i.down.outgoing(o.data,o.origin,function(e){l=!1,o.callback&&a(function(){o.callback(e)},0),t()})}}var i,n,s=[],l=!0,d="",u=0,c=!1,p=!1;return i={init:function(){_(e)&&(e={}),e.maxLength&&(u=e.maxLength,p=!0),e.lazy?c=!0:i.down.init()},callback:function(e){l=!1;var n=i.up;t(),n.callback(e)},incoming:function(t,n){if(p){var a=t.indexOf("_"),r=parseInt(t.substring(0,a),10);d+=t.substring(a+1),0===r&&(e.encode&&(d=o(d)),i.up.incoming(d,n),d="")}else i.up.incoming(t,n)},outgoing:function(n,a,o){e.encode&&(n=r(n));var l,d=[];if(p){for(;0!==n.length;)l=n.substring(0,u),n=n.substring(l.length),d.push(l);for(;l=d.shift();)s.push({data:d.length+"_"+l,origin:a,callback:0===d.length?o:null})}else s.push({data:n,origin:a,callback:o});c?i.down.init():t()},destroy:function(){n=!0,i.down.destroy()}}},B.stack.VerifyBehavior=function(e){function t(){n=Math.random().toString(16).substring(2),i.down.outgoing(n)}var i,n,a;return i={incoming:function(o,r){var s=o.indexOf("_");-1===s?o===n?i.up.callback(!0):a||(a=o,e.initiate||t(),i.down.outgoing(o)):o.substring(0,s)===a&&i.up.incoming(o.substring(s+1),r)},outgoing:function(e,t,a){i.down.outgoing(n+"_"+e,t,a)},callback:function(i){e.initiate&&t()}}},B.stack.RpcBehavior=function(e,t){function i(e){e.jsonrpc="2.0",o.down.outgoing(r.stringify(e))}function n(e,t){var n=Array.prototype.slice;return function(){var a,o=arguments.length,r={method:t};o>0&&"function"==typeof arguments[o-1]?(o>1&&"function"==typeof arguments[o-2]?(a={success:arguments[o-2],error:arguments[o-1]},r.params=n.call(arguments,0,o-2)):(a={success:arguments[o-1]},r.params=n.call(arguments,0,o-1)),l[""+ ++s]=a,r.id=s):r.params=n.call(arguments,0),e.namedParams&&1===r.params.length&&(r.params=r.params[0]),i(r)}}function a(e,t,n,a){if(!n)return void(t&&i({id:t,error:{code:-32601,message:"Procedure not found."}}));var o,r;t?(o=function(e){o=F,i({id:t,result:e})},r=function(e,n){r=F;var a={id:t,error:{code:-32099,message:e}};n&&(a.error.data=n),i(a)}):o=r=F,d(a)||(a=[a]);try{var s=n.method.apply(n.scope,a.concat([o,r]));_(s)||o(s)}catch(e){r(e.message)}}var o,r=t.serializer||K(),s=0,l={};return o={incoming:function(e,n){var o=r.parse(e);if(o.method)t.handle?t.handle(o,i):a(o.method,o.id,t.local[o.method],o.params);else{var s=l[o.id];o.error?s.error&&s.error(o.error):s.success&&s.success(o.result),delete l[o.id]}},init:function(){if(t.remote)for(var i in t.remote)t.remote.hasOwnProperty(i)&&(e[i]=n(t.remote[i],i));o.down.init()},destroy:function(){for(var i in t.remote)t.remote.hasOwnProperty(i)&&e.hasOwnProperty(i)&&delete e[i];o.down.destroy()}}},e.exports=B}(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent)},45:function(e,t){!function(e){"use strict";function t(t){var i="dragover"===t;return function(n){n.dataTransfer=n.originalEvent&&n.originalEvent.dataTransfer;var a=n.dataTransfer;a&&-1!==e.inArray("Files",a.types)&&!1!==this._trigger(t,e.Event(t,{delegatedEvent:n}))&&(n.preventDefault(),i&&(a.dropEffect="copy"))}}e.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||e('<input type="file">').prop("disabled")),e.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),e.support.xhrFormDataFileUpload=!!window.FormData,e.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:void 0,fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,i){return t=this.messages[t]||t.toString(),i&&e.each(i,function(e,i){t=t.replace("{"+e+"}",i)}),t},formData:function(e){return e.serializeArray()},add:function(t,i){if(t.isDefaultPrevented())return!1;(i.autoUpload||!1!==i.autoUpload&&e(this).fileupload("option","autoUpload"))&&i.process().done(function(){i.submit()})},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:e.support.blobSlice&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,i){var n=e-this.timestamp;return(!this.bitrate||!i||n>i)&&(this.bitrate=(t-this.loaded)*(1e3/n)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var i;return"function"===e.type(t.formData)?t.formData(t.form):e.isArray(t.formData)?t.formData:"object"===e.type(t.formData)?(i=[],e.each(t.formData,function(e,t){i.push({name:e,value:t})}),i):[]},_getTotal:function(t){var i=0;return e.each(t,function(e,t){i+=t.size||1}),i},_initProgressObject:function(t){var i={loaded:0,total:0,bitrate:0};t._progress?e.extend(t._progress,i):t._progress=i},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)e._response.hasOwnProperty(t)&&delete e._response[t];else e._response={}},_onProgress:function(t,i){if(t.lengthComputable){var n,a=Date.now?Date.now():(new Date).getTime();if(i._time&&i.progressInterval&&a-i._time<i.progressInterval&&t.loaded!==t.total)return;i._time=a,n=Math.floor(t.loaded/t.total*(i.chunkSize||i._progress.total))+(i.uploadedBytes||0),this._progress.loaded+=n-i._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(a,this._progress.loaded,i.bitrateInterval),i._progress.loaded=i.loaded=n,i._progress.bitrate=i.bitrate=i._bitrateTimer.getBitrate(a,n,i.bitrateInterval),this._trigger("progress",e.Event("progress",{delegatedEvent:t}),i),this._trigger("progressall",e.Event("progressall",{delegatedEvent:t}),this._progress)}},_initProgressListener:function(t){var i=this,n=t.xhr?t.xhr():e.ajaxSettings.xhr();n.upload&&(e(n.upload).bind("progress",function(e){var n=e.originalEvent;e.lengthComputable=n.lengthComputable,e.loaded=n.loaded,e.total=n.total,i._onProgress(e,t)}),t.xhr=function(){return n})},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(t){var i,n=this,a=t.files[0],o=t.multipart||!e.support.xhrFileUpload,r="array"===e.type(t.paramName)?t.paramName[0]:t.paramName;t.headers=e.extend({},t.headers),t.contentRange&&(t.headers["Content-Range"]=t.contentRange),o&&!t.blob&&this._isInstanceOf("File",a)||(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(a.name)+'"'),o?e.support.xhrFormDataFileUpload&&(t.postMessage?(i=this._getFormData(t),t.blob?i.push({name:r,value:t.blob}):e.each(t.files,function(n,a){i.push({name:"array"===e.type(t.paramName)&&t.paramName[n]||r,value:a})})):(n._isInstanceOf("FormData",t.formData)?i=t.formData:(i=new FormData,e.each(this._getFormData(t),function(e,t){i.append(t.name,t.value)})),t.blob?i.append(r,t.blob,a.name):e.each(t.files,function(a,o){(n._isInstanceOf("File",o)||n._isInstanceOf("Blob",o))&&i.append("array"===e.type(t.paramName)&&t.paramName[a]||r,o,o.uploadName||o.name)})),t.data=i):(t.contentType=a.type||"application/octet-stream",t.data=t.blob||a),t.blob=null},_initIframeSettings:function(t){var i=e("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&i&&i!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(t){var i=e(t.fileInput),n=t.paramName;return n?e.isArray(n)||(n=[n]):(n=[],i.each(function(){for(var t=e(this),i=t.prop("name")||"files[]",a=(t.prop("files")||[1]).length;a;)n.push(i),a-=1}),n.length||(n=[i.prop("name")||"files[]"])),n},_initFormSettings:function(t){t.form&&t.form.length||(t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||"string"===e.type(t.form.prop("method"))&&t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&"PATCH"!==t.type&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var i=e.extend({},this.options,t);return this._initFormSettings(i),this._initDataSettings(i),i},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,i,n){var a=e.Deferred(),o=a.promise();return i=i||this.options.context||o,!0===t?a.resolveWith(i,n):!1===t&&a.rejectWith(i,n),o.abort=a.promise,this._enhancePromise(o)},_addConvenienceMethods:function(t,i){var n=this,a=function(t){return e.Deferred().resolveWith(n,t).promise()};i.process=function(t,o){return(t||o)&&(i._processQueue=this._processQueue=(this._processQueue||a([this])).pipe(function(){return i.errorThrown?e.Deferred().rejectWith(n,[i]).promise():a(arguments)}).pipe(t,o)),this._processQueue||a([this])},i.submit=function(){return"pending"!==this.state()&&(i.jqXHR=this.jqXHR=!1!==n._trigger("submit",e.Event("submit",{delegatedEvent:t}),this)&&n._onSend(t,this)),this.jqXHR||n._getXHRPromise()},i.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",n._trigger("fail",null,this),n._getXHRPromise(!1))},i.state=function(){return this.jqXHR?n._getDeferredState(this.jqXHR):this._processQueue?n._getDeferredState(this._processQueue):void 0},i.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===n._getDeferredState(this._processQueue)},i.progress=function(){return this._progress},i.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),i=t&&t.split("-"),n=i&&i.length>1&&parseInt(i[1],10);return n&&n+1},_chunkedUpload:function(t,i){t.uploadedBytes=t.uploadedBytes||0;var n,a,o=this,r=t.files[0],s=r.size,l=t.uploadedBytes,d=t.maxChunkSize||s,u=this._blobSlice,c=e.Deferred(),p=c.promise();return!(!(this._isXHRUpload(t)&&u&&(l||d<s))||t.data)&&(!!i||(l>=s?(r.error=t.i18n("uploadedBytes"),this._getXHRPromise(!1,t.context,[null,"error",r.error])):(a=function(){var i=e.extend({},t),p=i._progress.loaded;i.blob=u.call(r,l,l+d,r.type),i.chunkSize=i.blob.size,i.contentRange="bytes "+l+"-"+(l+i.chunkSize-1)+"/"+s,o._initXHRData(i),o._initProgressListener(i),n=(!1!==o._trigger("chunksend",null,i)&&e.ajax(i)||o._getXHRPromise(!1,i.context)).done(function(n,r,d){l=o._getUploadedBytes(d)||l+i.chunkSize,p+i.chunkSize-i._progress.loaded&&o._onProgress(e.Event("progress",{lengthComputable:!0,loaded:l-i.uploadedBytes,total:l-i.uploadedBytes}),i),t.uploadedBytes=i.uploadedBytes=l,i.result=n,i.textStatus=r,i.jqXHR=d,o._trigger("chunkdone",null,i),o._trigger("chunkalways",null,i),l<s?a():c.resolveWith(i.context,[n,r,d])}).fail(function(e,t,n){i.jqXHR=e,i.textStatus=t,i.errorThrown=n,o._trigger("chunkfail",null,i),o._trigger("chunkalways",null,i),c.rejectWith(i.context,[e,t,n])})},this._enhancePromise(p),p.abort=function(){return n.abort()},a(),p)))},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(t,i,n,a){var o=a._progress.total,r=a._response;a._progress.loaded<o&&this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:o,total:o}),a),r.result=a.result=t,r.textStatus=a.textStatus=i,r.jqXHR=a.jqXHR=n,this._trigger("done",null,a)},_onFail:function(e,t,i,n){var a=n._response;n.recalculateProgress&&(this._progress.loaded-=n._progress.loaded,this._progress.total-=n._progress.total),a.jqXHR=n.jqXHR=e,a.textStatus=n.textStatus=t,a.errorThrown=n.errorThrown=i,this._trigger("fail",null,n)},_onAlways:function(e,t,i,n){this._trigger("always",null,n)},_onSend:function(t,i){i.submit||this._addConvenienceMethods(t,i);var n,a,o,r,s=this,l=s._getAJAXSettings(i),d=function(){return s._sending+=1,l._bitrateTimer=new s._BitrateTimer,n=n||((a||!1===s._trigger("send",e.Event("send",{delegatedEvent:t}),l))&&s._getXHRPromise(!1,l.context,a)||s._chunkedUpload(l)||e.ajax(l)).done(function(e,t,i){s._onDone(e,t,i,l)}).fail(function(e,t,i){s._onFail(e,t,i,l)}).always(function(e,t,i){if(s._onAlways(e,t,i,l),s._sending-=1,s._active-=1,l.limitConcurrentUploads&&l.limitConcurrentUploads>s._sending)for(var n=s._slots.shift();n;){if("pending"===s._getDeferredState(n)){n.resolve();break}n=s._slots.shift()}0===s._active&&s._trigger("stop")})};return this._beforeSend(t,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(o=e.Deferred(),this._slots.push(o),r=o.pipe(d)):(this._sequence=this._sequence.pipe(d,d),r=this._sequence),r.abort=function(){return a=[void 0,"abort","abort"],n?n.abort():(o&&o.rejectWith(l.context,a),d())},this._enhancePromise(r)):d()},_onAdd:function(t,i){var n,a,o,r,s=this,l=!0,d=e.extend({},this.options,i),u=i.files,c=u.length,p=d.limitMultiFileUploads,m=d.limitMultiFileUploadSize,h=d.limitMultiFileUploadSizeOverhead,f=0,g=this._getParamName(d),v=0;if(!m||c&&void 0!==u[0].size||(m=void 0),(d.singleFileUploads||p||m)&&this._isXHRUpload(d))if(d.singleFileUploads||m||!p)if(!d.singleFileUploads&&m)for(o=[],n=[],r=0;r<c;r+=1)f+=u[r].size+h,(r+1===c||f+u[r+1].size+h>m||p&&r+1-v>=p)&&(o.push(u.slice(v,r+1)),a=g.slice(v,r+1),a.length||(a=g),n.push(a),v=r+1,f=0);else n=g;else for(o=[],n=[],r=0;r<c;r+=p)o.push(u.slice(r,r+p)),a=g.slice(r,r+p),a.length||(a=g),n.push(a);else o=[u],n=[g];return i.originalFiles=u,e.each(o||u,function(a,r){var d=e.extend({},i);return d.files=o?r:[r],d.paramName=n[a],s._initResponseObject(d),s._initProgressObject(d),s._addConvenienceMethods(t,d),l=s._trigger("add",e.Event("add",{delegatedEvent:t}),d)}),l},_replaceFileInput:function(t){var i=t.fileInput,n=i.clone(!0);t.fileInputClone=n,e("<form></form>").append(n)[0].reset(),i.after(n).detach(),e.cleanData(i.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,t){return t===i[0]?n[0]:t}),i[0]===this.element[0]&&(this.element=n)},_handleFileTreeEntry:function(t,i){var n,a=this,o=e.Deferred(),r=function(e){e&&!e.entry&&(e.entry=t),o.resolve([e])},s=function(e){a._handleFileTreeEntries(e,i+t.name+"/").done(function(e){o.resolve(e)}).fail(r)},l=[];return i=i||"",t.isFile?t._file?(t._file.relativePath=i,o.resolve(t._file)):t.file(function(e){e.relativePath=i,o.resolve(e)},r):t.isDirectory?(n=t.createReader(),function e(){n.readEntries(function(t){t.length?(l=l.concat(t),e()):s(l)},r)}()):o.resolve([]),o.promise()},_handleFileTreeEntries:function(t,i){var n=this;return e.when.apply(e,e.map(t,function(e){return n._handleFileTreeEntry(e,i)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var i=t.items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(e.map(i,function(e){var t;return e.webkitGetAsEntry?(t=e.webkitGetAsEntry(),t&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=e(t);var i,n,a=t.prop("webkitEntries")||t.prop("entries");if(a&&a.length)return this._handleFileTreeEntries(a);if(i=e.makeArray(t.prop("files")),i.length)void 0===i[0].name&&i[0].fileName&&e.each(i,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(!(n=t.prop("value")))return e.Deferred().resolve([]).promise();i=[{name:n.replace(/^.*\\/,"")}]}return e.Deferred().resolve(i).promise()},_getFileInputFiles:function(t){return t instanceof e&&1!==t.length?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var i=this,n={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(n.fileInput).always(function(a){n.files=a,i.options.replaceFileInput&&i._replaceFileInput(n),!1!==i._trigger("change",e.Event("change",{delegatedEvent:t}),n)&&i._onAdd(t,n)})},_onPaste:function(t){var i=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,n={files:[]};i&&i.length&&(e.each(i,function(e,t){var i=t.getAsFile&&t.getAsFile();i&&n.files.push(i)}),!1!==this._trigger("paste",e.Event("paste",{delegatedEvent:t}),n)&&this._onAdd(t,n))},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var i=this,n=t.dataTransfer,a={};n&&n.files&&n.files.length&&(t.preventDefault(),this._getDroppedFiles(n).always(function(n){a.files=n,!1!==i._trigger("drop",e.Event("drop",{delegatedEvent:t}),a)&&i._onAdd(t,a)}))},_onDragOver:t("dragover"),_onDragEnter:t("dragenter"),_onDragLeave:t("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste})),e.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(t,i){var n=-1!==e.inArray(t,this._specialOptions);n&&this._destroyEventHandlers(),this._super(t,i),n&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;void 0===t.fileInput?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_getRegExp:function(e){var t=e.split("/"),i=t.pop();return t.shift(),new RegExp(t.join("/"),i)},_isRegExpOption:function(t,i){return"url"!==t&&"string"===e.type(i)&&/^\/.*\/[igm]{0,3}$/.test(i)},_initDataAttributes:function(){var t=this,i=this.options,n=this.element.data();e.each(this.element[0].attributes,function(e,a){var o,r=a.name.toLowerCase();/^data-/.test(r)&&(r=r.slice(5).replace(/-[a-z]/g,function(e){return e.charAt(1).toUpperCase()}),o=n[r],t._isRegExpOption(r,o)&&(o=t._getRegExp(o)),i[r]=o)})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var i=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,i._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var i,n,a=this,o=e.Deferred(),r=o.promise();return r.abort=function(){return n=!0,i?i.abort():(o.reject(null,"abort","abort"),r)},this._getFileInputFiles(t.fileInput).always(function(e){if(!n){if(!e.length)return void o.reject();t.files=e,i=a._onSend(null,t),i.then(function(e,t,i){o.resolve(e,t,i)},function(e,t,i){o.reject(e,t,i)})}}),this._enhancePromise(r)}if(t.files=e.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}(window.$)},56:function(e,t){window.POWrDateTimeComponentWithIncrementer=function(e){PowrStrap.call(this,e),this.dateTimeState=moment_custom(this.initial_date||new Date),this.timeComponent=new POWrTimePickerComponent({using_native_inputs:this.using_native_inputs,use_local:this.use_local,$body:this.timeSelectEls||null}).on("change",function(e){var t=e.timeState;this.dateTimeState.hour(t.hours(null,this.use_local),this.use_local),this.dateTimeState.minute(t.minutes(null,this.use_local),this.use_local),this.dateTimeState.second(t.seconds(null,this.use_local),this.use_local),this._setHiddenInput()}.bind(this)),this.dateComponent=new POWrDatePickerComponent({using_native_inputs:this.using_native_inputs,initial_date:this.dateTimeState,use_local:this.use_local,$body:this.dateSelectEls||null}).on("change",function(e){this.dateTimeState.year(e.dateState.year(null,this.use_local),this.use_local),this.dateTimeState.month(e.dateState.month(null,this.use_local),this.use_local),this.dateTimeState.date(e.dateState.date(null,this.use_local),this.use_local),this._setDateHiddenInput()}.bind(this));this.formatString=this.formatString||"MM-DD-YYYY",this.setFormat(this.formatString),this._init()},POWrDateTimeComponentWithIncrementer.prototype={ModuleName:"POWrDateTimeComponentWithIncrementer",_init:function(){this.using_native_inputs||(this._setDateInput(),this._setTimeComponent(),this._setHiddenInput())},setDateTimeState:function(e){this.dateTimeState=moment_custom(e),this._init()},_setDateInput:function(){this.dateComponent.setDateState(this.dateTimeState)},_setTimeComponent:function(){this.timeComponent.setTimeState(this.dateTimeState)},_setHiddenInput:function(){var e=this.use_local?this.dateTimeState.toLocaleISOString():this.dateTimeState.toISOString();this.$dateTimeHidden.attr("value",e),this.$dateTimeHidden.val(e),this.$dateTimeHidden.trigger("change")},_setDateHiddenInput:function(){var e=[this.dateTimeState.year().toString(),(1+this.dateTimeState.month()).toString(),this.dateTimeState.date().toString()],t=e.map(function(e){return 1===e.length?"0"+e:e}).join("-"),i=t+"T"+this.$dateTimeHidden.val().split("T")[1];this.$dateTimeHidden.attr("value",i),this.$dateTimeHidden.val(i),this.$dateTimeHidden.trigger("change")},setFormat:function(e){if(!e)throw"Bad things";this.formatString=e,this.$dateTimeFormatHidden.attr("value",e),this.$dateTimeFormatHidden.val(e),this.$dateTimeFormattedHidden.attr("value",this.dateTimeState.format(e)),this.$dateTimeFormattedHidden.val(this.dateTimeState.format(e)),this._setHiddenInput(),this.dateComponent.setFormat(this.formatString),this.trigger("change"),this.$dateTimeFormatHidden.trigger("change")},_html:function(){return["<div>",'<div pwr pwr-mod-attr="datePickerContainer" type="text">',"</div>",'<div pwr pwr-mod-attr="timePickerContainer" type="text">',"</div>",'<div pwr pwr-mod-attr="formatPickerContainer" type="text">',"</div>",'<input pwr pwr-mod-attr="dateTimeHidden" style="display:none;" type="text">','<input pwr pwr-mod-attr="dateTimeFormatHidden" style="display:none;" type="text">','<input pwr pwr-mod-attr="dateTimeFormattedHidden" style="display:none;" type="text">',"</div>"].join("\n")}()}},7:function(e,t,i){i(8),i(4),i(9),$(function(){"undefined"!=typeof onAppModelViewDefined&&onAppModelViewDefined()})},8:function(e,t){!function(e){"use strict";e.fn.konami=function(t){var i,n,a;return i=e.extend({},e.fn.konami.defaults,t),this.each(function(){n=[],e(window).keyup(function(e){a=e.keyCode||e.which,i.code.length>n.push(a)||(i.code.length<n.length&&n.shift(),i.code.toString()===n.toString()&&i.cheat())})})},e.fn.konami.defaults={code:[38,38,40,40,37,39,37,39,66,65],cheat:null}}(jQuery)},859:function(e,t,i){i(264),i(26),i(32),i(27),i(33),i(31),i(34),i(56),i(72);var n=i(860);$(function(){formBuilderBaseModel=appModel.extend({baseDefaults:function(){var e={defaultDateFormat:"MM-DD-YYYY",afterSubmission:"clearAndPrevent",preventMultiple:!1,redirectLink:"",ownerEmail:"",carrier:"",carrierLabel:"",phoneNumber:"",phoneValid:!1,pattern:!1,printable:!1,patternType:"subtle_white_feathers",removePowrLogo:!1,multistepForm:!1,title:"Form Title",description:"",data:[{type:"text",label:"Example text field",half:!1,required:!1,isDefault:!0},{type:"select",label:"Example Dropdown",options:["Option 1","Option 2","Option 3"],half:!1,required:!1,isDefault:!0},{type:"textarea",label:"Example textarea",half:!1,required:!1,isDefault:!0},{type:"radio",label:"Example Radio",options:["Option A","Option B","Option C"],half:!1,required:!1,radioAlign:"horizontal",isDefault:!0}],mailchimpList:"",mailchimpListName:"",emailSubject:"",emailBody:"",emailName:"",emailAddress:"",customAdminEmails:!1,adminSubjectVariable:"",adminEmailName:"",adminSubjectMessage:"",includeSkippedFields:!1,paymentRequired:!1,paypalQuantity:1,quantityLabel:"Quantity",paypalButtonText:"Purchase",showQuantityInput:!1,showPriceSummary:!0,paypalPaypalAccount:"",paypalCurrencyCode:"USD",paypalPurchaseType:"BuyNow",paypalItemName:"My product",paypalItemCost:"",paypalAllowUserToSpecifyPrice:!1,paypalAllowUserToSpecifyQuantity:!1,paypalTrialOn:!1,paypalTrialPrice:0,paypalTrialDuration:30,paypalTrialDurationUnits:"D",paypalSubscriptionPrice:10,paypalSubscriptionDuration:1,paypalSubscriptionDurationUnits:"M",paypalShippingCost:"",paypalNoShipping:"0",titleFontFamily:"Open Sans",titleFontSize:"28px",titleFontColor:"rgb(56, 56, 56)",textFontFamily:"Open Sans",textFontSize:"12px",textFontColor:"rgb(86, 86, 86)",googleSheetsConnected:!1,buttonBackgroundColor:"rgb(86, 86, 86)",buttonColor:"#FFF",buttonRadius:"4px",backgroundGradient:!1,backgroundColor:"#FFF",backgroundStartColor:"#d5d5d5",backgroundEndColor:"#333",backgroundBorderColor:"rgb(238, 238, 238)",backgroundBorderRadius:"4px",backgroundBorderWidth:"1px",backgroundShadow:"none",inputBackgroundColor:"#FFF",inputBorderRadius:"4px",inputFontColor:"#333",inputFontSize:"12px",inputFontFamily:"Open Sans",discountCodeText:"Discount Code",discounts:[],passwordProtectOn:!1,titleAlign:"left",successText:"Received. Thank you!",buttonText:"Submit",nextButtonText:"Next",backButtonText:"Back",buttonAlign:"leftBtn",captchaRequired:!1,labelType:"inlineLabels",pluginWidth:"500px",introAnimation:"none",buttonAnimation:"none",customCSS:"",customJS:"",template:"form_template_custom"};return"wix"==HOST&&(e.titleFontColorWix="color-3",e.textFontColorWix="color-4",e.inputBackgroundColorWix="color-1",e.inputFontColorWix="color-4",e.backgroundColorWix="color-1",e.backgroundStartColorWix="color-1",e.backgroundEndColorWix="color-2",e.buttonColorWix="color-1",e.buttonBackgroundColorWix="color-4",e.backgroundBorderColorWix="color-4",e.pluginWidth="1000px"),e},presets:function(){return{titleFontColor:"color",textFontColor:"color",inputBackgroundColor:"backgroundColor",inputFontColor:"color",backgroundColor:"backgroundColor",backgroundStartColor:"backgroundColor",backgroundEndColor:"backgroundColor",buttonColor:"backgroundColor",buttonBackgroundColor:"color",backgroundBorderColor:"color",titleFontFamily:"fontFamily",textFontFamily:"fontFamily"}},syncLocalData:function(e){e=e||!1;var t=this.get("locals"),i=t.data&&t.data.length,n=JSON.parse(JSON.stringify(this.get("data")));n=n.map(function(n,a){if(n.idx=a,!e){var o=i?t.data[a]:null;o&&!t.data[0].isDefault&&["value","src","selectedOption","dateTimeHidden","selectedOptions","address1","address2","city","state","zip","country","checked"].forEach(function(e){n[e]=o[e]})}return"signature"!==n.type||n.value||(n.value=$("#signature-"+n.idx).next(".signatureImage").prop("src")),n}),this.setLocals({data:n})},afterMount:function(){}}),formBuilderAppModel=formBuilderBaseModel,orderFormAppModel=formBuilderBaseModel,contactFormAppModel=formBuilderBaseModel,mailingListAppModel=formBuilderBaseModel,surveyAppModel=formBuilderBaseModel,pollAppModel=formBuilderBaseModel,wixDevAppModel=formBuilderAppModel,stagingDevAppModel=formBuilderAppModel,localDevAppModel=formBuilderAppModel,formBuilderAppSettings=appSettings.extend({beforeInitialize:function(){var e=this;e.formElementsSettingsModule=new formElementsSettingsModule(this,{formDataKey:"data",paymentRequiredKey:"paymentRequired"}),e.model.settings=e},googleSheetsAuthSuccess:function(){this.$el.find("[name=googleSheetsConnected]").prop("checked",!0),this.$el.find("[name=includeSkippedFields]").prop("checked",!0),this.$el.find(".sheetButton").prop("href",this.model.meta.external_data.sheet_url),this.update()},googleSheetsDisconnectSuccess:function(){this.$el.find("[name=googleSheetsConnected]").prop("checked",!1),this.update()},afterInitialize:function(){var e=this,t=(this.model,this.$el);t.on("click",".customizeConfirmationEmail",function(t){t.preventDefault(),e.openPowrMailEditor(t)}),t.on("click",".triggerElementModal",function(){$(this).hasClass("premium")||t.find("#elementsModal").modal("show")}),t.on("change","[name=showResponse]",function(){debug()("Change in show response detected"),$(this).prop("checked")&&(debug()("Prop is checked, changing aftersubmission"),t.find("[name=afterSubmission]").val("responses").trigger("change"),"wix"==HOST&&Wix.UI.set("afterSubmission",{value:"responses"}))}),t.on("keyup",'[name="successText"]',function(t){e.model.setLocals({successMessageDraft:t.target.value}),setTimeout(function(){e.model.setLocals({successMessageDraft:null})},5e3)}),t.on("change","[name=googleSheetsConnected]",function(){e.model.meta.external_data&&e.model.meta.external_data.google_sheets_connected?$(this).hasClass("on")?e.model.set({googleSheetsConnected:!1}):e.model.set({googleSheetsConnected:!0}):(window.name=e.model.meta.id,window.open("/google/connect_sheets/"+e.model.meta.id,"_blank"))}),t.on("change","[name=sendConfirmationEmailHack]",function(){$(this).prop("checked")?e.setActiveConfirmationEmail():e.removeConfirmationEmail(),e.update()}),t.on("change","[name=confirmationEmailFieldIdx]",function(){e.setActiveConfirmationEmail(),e.update()}),this.updatePaymentVisibility(),this.updateAdminEmailVisibility(),e.initializePaypalSettings("paypal"),e.initializeAutocompletes(),e.loadTemplates(),e.updateConditionals(),t.on("click",".phoneSuccess",function(){var t=$(this),i=function(e){t.children().not(e).slideUp(),t.find(e).slideDown()};if("free"!=e.model.meta.premium_status)if(e.model.get("phoneValid")){var n=parseInt(t.data("last-sent")||0);(new Date).valueOf()-n>15e3?(i(".duringSent"),t.data("last-sent",(new Date).valueOf()),ajaxController({url:"/form-responses/send-text",data:{id:e.model.meta.id,carrier:e.model.get("carrier"),number:e.model.get("phoneNumber")},type:"POST"},function(e){e.success&&i(".afterSent")})):(i(".alreadySending"),window.ALREADY_SENDING_TIMEOUT&&clearTimeout(ALREADY_SENDING_TIMEOUT),window.ALREADY_SENDING_TIMEOUT=setTimeout(function(){i(".beforeSent")},15e3-((new Date).valueOf()-n)))}else i(".sendInvalid"),window.SEND_INVALID_TIMEOUT&&clearTimeout(SEND_INVALID_TIMEOUT),window.SEND_INVALID_TIMEOUT=setTimeout(function(){i(".beforeSent")},2500)}),t.on("change","[name=afterSubmission]",function(){"clearAndAllow"==$(this).val()&&(t.find("[name=preventMultiple]").prop("checked",!1).trigger("change"),e.updateConditionals())}),t.on("change","[name=isShippingAddress]",function(){$(this).prop("checked")&&(t.find("[name=isShippingAddress]").prop("checked",!1),$(this).prop("checked",!0))}),t.on("click",".mailchimpButton",function(){"free"!=e.model.meta.premium_status&&window.open("/mailchimp/connect/"+e.model.meta.id+"?external_user_id="+(e.model.meta.external_user_id||""),"_blank",'toolbar=0,location=0,menubar=0,height=650,width=300,scrollbars=1"')}),t.on("change",'[name="multistepForm"]',function(){e.handleMultistepForms($(this)),e.model.triggerChange()}),t.on("change","[name=displayType]",function(){var e=$(this),t=e.val(),i=e.parents(".formElementsWrapper"),n=i.find('[name="dateFormat"]').parents(".selectWrapper"),a=i.find(".istwentyfourCheckbox");"time"===t?(n.hide(),a.show()):"date"===t?(n.show(),a.hide()):(n.show(),a.show())});POWr.simpleCopies("upgrade_required"),POWr.simpleCopies("premium_text_1")},openPowrMailEditor:function(e){var t=this;if(!t.model.meta.saved)return e.preventDefault(),$(".triggerPublish").click(),void(CHELSEA_SAVE_FLOW=function(){$(".customizeConfirmationEmail").click()});var i=$(".customizeConfirmationEmail").find("span").text();$(".customizeConfirmationEmail").find("span").text("Loading..."),ajaxController({url:"/powrzilla/editor?app_id="+META.id+"&email_type=confirmation",type:"GET"},function(e){window.CURRENT_USER=e.data.CURRENT_USER,window.EMAIL_ID=e.data.EMAIL_ID,window.EMAIL_TYPE=e.data.EMAIL_TYPE,window.SAVED_STATE=e.data,window.FORM_RESPONSE=t.getPowrMailFormResponse(),window.APP_ID=e.data.APP_ID,window.FORM_URL=e.data.FORM_URL,window.PREMIUM_STATUS=META.premium_status;var n=e.scripts.split('src="')[1].split('"')[0],a=e.scripts.split('href="')[1].split('"')[0];$.getScript(n,function(){$.get(a,function(e){$(".js-powr-mail-editor-modal").append('<style id="powrMailCSS">'+e+"</style>"),$(".customizeConfirmationEmail").find("span").text(i),$(".js-powr-mail-editor-modal").modal("show"),$(document).on("click",".js-powr-mail-save",function(e){t.model.save()}),$(document).off("focusin.modal"),$(window).trigger("user_loaded")})}),window.__insp&&window.__insp.push(["tagSession","powrmail"])})},getPowrMailFormResponse:function(){return this.model.attributes.data.map(function(e){return{label:"response_"+n.hex(e.label),display_label:e.label}})},setConfirmationEmailHack:function(){var e=this.$el.find('[name="sendConfirmationEmail"]:checked').length>0;this.$el.find("[name=sendConfirmationEmailHack]").prop("checked",e)},removeConfirmationEmail:function(){this.$el.find("[name=sendConfirmationEmail]").prop("checked",!1)},setActiveConfirmationEmail:function(){this.removeConfirmationEmail();var e=this.$el.find("[name=confirmationEmailFieldIdx]").val();void 0!=e&&$(this.$el.find(".formElements:not(.prototype)")[e]).find("[name=sendConfirmationEmail]").prop("checked",!0)},afterUpdate:function(){var e=this;e.formElementsSettingsModule.readFormElements();var t=[];this.$el.find(".ownerEmail.prototype-element:not(.prototype)").each(function(){t.push($(this).find("[name='ownerEmailPart']").val())});var i=t.toString(),n=this.$el.find('[name="buttonText"]'),a=n.val()||n.prop("placeholder"),o=e.model.get("data").filter(function(e){return"step"===e.type}),r=o.length>1;try{localStorage.removeItem("Form_"+e.model.meta.id+"_locals"),localStorage.removeItem("Form_"+e.model.meta.id+"_timestamp")}catch(e){}this.model.set({ownerEmail:i,buttonText:a,multistepForm:r},{silent:!0}),this.model.triggerChange(),this.updateAdminMessage(),this.updateConditionals(),this.initializeInputs(),this.updatePaymentVisibility(),this.updateAdminEmailVisibility(),this.populateSubjectLineOptions(),this.initializeWixDropdowns(),this.formElementsSettingsModule.updateFormElementConditionals(),this.handleMultistepForms()},afterSort:function(){this.afterUpdate(),this.handleMultistepForms()},populateSubjectLineOptions:function(){var e=this,t=this.$el.find('[name="adminSubjectVariable"]');t.html('<option value="None">None</option>'),this.model.get("data").filter(function(e){return e.label}).forEach(function(i){e.model.get("adminSubjectVariable")===i.label?t.append('<option selected value="'+i.label+'">'+i.label+"</option>"):t.append('<option value="'+i.label+'">'+i.label+"</option>")}),e.updatePremiumContent()},maxNumberOfElements:function(){var e=this.model.get("data").length;return parseInt(this.$el.find(".triggerElementModal").attr("data-"+this.model.meta.premium_status+"-limit"))<e},handleMultistepForms:function(e){e=e||null;var t=this.model.get("data");e?e.prop("checked")?"step"!==t[0].type&&(this.model.setLocals({currenStepIdx:0,previousStepIdxs:[],nextStepIdx:null}),this.model.set({multistepForm:!0,data:[{type:"step"}].concat(t)})):(t=t.filter(function(e){return"step"!==e.type}),this.model.setLocals({currenStepIdx:0,previousStepIdxs:[],nextStepIdx:null}),this.model.set({multistepForm:!1,data:t})):this.model.get("multistepForm")&&!this.maxNumberOfElements()?(this.model.setLocals({currenStepIdx:0,previousStepIdxs:[],nextStepIdx:null}),"step"!==t[0].type&&this.model.set({data:[{type:"step"}].concat(t)})):(t=t.filter(function(e){return"step"!==e.type}),this.model.set({data:t})),this.$el.find("#formBackButton").hide(),this.model.syncLocalData(!0);var i=this.$el.find(".formElements .panel-collapse").map(function(e,t){if("block"===t.style.display)return $(t).find(".form-element.hid").prop("id")}).toArray(),n=this.$el.find(".formElements .hideText").map(function(e,t){return $(t).parent().find(".form-element").first().prop("id")}).toArray(),a=this.$el.find(".connect").scrollTop()||this.$el.find(".wixSection.connectTabSelector").scrollTop();this.model.setLocals({expandedPanels:i,expandedAdvancedSections:n});var a=this.$el.find(".connect").scrollTop()||this.$el.find(".wixSection.connectTabSelector").scrollTop();this.$el.find(":focus");this.model.get("locals").editingSteps&&(this.formElementsSettingsModule.renderFormElements(a),this.model.setLocals({editingSteps:!1})),this.model.get("mailchimpListName")&&($(".exportField").show(),$(".ifMailchimp").show()),this.maxNumberOfElements()&&this.$el.find(".triggerElementModal").addClass("premium")},initializeInputs:function(){this.initializeWixDropdowns(),this.renderEmailMediaBars(),this.initializeCheckboxes(),this.initializeWixCheckboxes(),this.validateExternalFields()},updatePaymentVisibility:function(){var e=this;e.model.get("paymentRequired")?e.$el.find(".paymentOptions").slideDown():e.$el.find(".paymentOptions").slideUp()},updateAdminEmailVisibility:function(){this.model.get("customAdminEmails")?this.$el.find(".customAdminEmails").slideDown():this.$el.find(".customAdminEmails").slideUp()},updateAdminMessage:function(){if("wix"==HOST){var e=this.$el.find("#collapseContent").parent(".panel");$(".tooltip").hide(),e.tooltip("destroy"),0==this.model.get("ownerEmail").length&&e.tooltip({title:"Enter admin email to receive responses"})}},updateConditionals:function(){var e=this;switch(this.model.get("afterSubmission")){case"clearAndPrevent":case"clearAndAllow":this.$el.find(".redirectLink").slideUp(),this.$el.find(".successText").slideDown();break;case"redirect":this.$el.find(".redirectLink").slideDown(),this.$el.find(".successText").slideUp();break;case"hide":this.$el.find(".redirectLink").slideUp(),this.$el.find(".successText").slideUp()}"clearAndAllow"==this.model.get("afterSubmission")?this.$el.find(".preventMultipleCheckbox").slideUp():this.$el.find(".preventMultipleCheckbox").slideDown(),this.$el.find(".use-twenty-four").each(function(){"date"==$(this).parents(".form-details").find('select[name="displayType"]').val()?$(this).slideUp():$(this).slideDown()}),this.model.get("showQuantityInput")?this.$el.find(".quantityDetails").slideDown():this.$el.find(".quantityDetails").slideUp(),this.model.get("pattern")?(this.$el.find(".patternType").show(),this.$el.find(".patternTypeOn").hide()):(this.$el.find(".patternType").hide(),this.$el.find(".patternTypeOn").show()),this.$el.find("[name=displayType]").each(function(){0==$(this).val().length&&$(this).val("both")}),""==this.model.get("carrierLabel")&&""!=this.model.get("carrier")&&this.model.set("carrier",""),this.checkPhoneFormat(),""==this.model.get("mailchimpList")?(this.$el.find(".needsToChoose").slideDown(),this.$el.find(".alreadyChose").slideUp(),this.$el.find(".continueMailchimp").hide(),this.$el.find(".continueMailchimp").css("display","none"),this.$el.find(".ifMailchimp").slideUp(),this.$el.find(".exportField").slideUp()):(this.$el.find(".needsToChoose").slideUp(),this.$el.find(".alreadyChose").slideDown(),this.$el.find(".alreadyChose").find(".mailchimpList").text(this.model.get("mailchimpListName")),this.$el.find(".continueMailchimp").css("display","inline-block"),this.$el.find(".ifMailchimp").slideDown(),this.$el.find(".exportField").slideDown()),this.makeSortable(".optionsWrapper",".optionsSort",!1),this.makeSortable(".discountWrapper",".discountSort",!0),this.$el.find('[name="limitingCharacters"]').each(function(){$(this).is(":checked")?$(this).closest(".form-details").find(".whenLimiting").slideDown():$(this).closest(".form-details").find(".whenLimiting").slideUp()}),e.model.meta.external_data&&e.model.meta.external_data.google_sheets_connected&&this.model.attributes.googleSheetsConnected?(this.$el.find(".sheetButton").show(),this.$el.find(".sheetDisconnectButton").show()):(this.$el.find(".sheetButton").hide(),this.$el.find(".sheetDisconnectButton").hide()),e.updateConfirmationEmailOptions(),e.model.get("multistepForm")?e.$el.find(".stepText").show():e.$el.find(".stepText").hide(),e.initializePopovers(),e.formElementsSettingsModule.updateFormElementConditionals()},updateConfirmationEmailOptions:function(){if(this.$el.find("[name=sendConfirmationEmailHack]").prop("checked")?this.$el.find(".sendConfirmationEmailDetails").slideDown():this.$el.find(".sendConfirmationEmailDetails").hide(),emailInputs=[],$.each(this.model.get("data"),function(e,t){"email"===t.type&&emailInputs.push({idx:e,label:t.label,selected:t.sendConfirmationEmail})}),emailInputs.length>0){var e=emailInputs.map(function(e){var t=e.selected?"selected":null;return'<option value="'+e.idx+'" '+t+">"+e.label+"</option>"}).join("");$('[name="confirmationEmailFieldIdx"]').html(e),this.$el.find(".selectConfirmationEmail").show(),this.$el.find(".addConfirmationEmailHelp").hide()}else this.$el.find(".selectConfirmationEmail").hide(),this.$el.find(".addConfirmationEmailHelp").show()},checkPhoneFormat:function(){var e=this,t=e.model.get("phoneNumber").replace(/\s|\.|-/g,"").replace(/^\+1(?=\d{10})/,"");if(0==t.length)return e.$el.find(".phoneErrors").slideUp(),void(e.model.get("phoneValid")&&e.model.set("phoneValid",!1));if(t.match(/^\d{10}$/)){e.$el.find(".phoneErrors").slideUp(),e.model.get("phoneNumber")!=t&&e.model.set("phoneNumber",t);var i=0!=e.model.get("carrier").length&&"Not supported"!=e.model.get("carrier");e.model.get("phoneValid")!=i&&e.model.set("phoneValid",i)}else e.$el.find(".phoneErrors").slideDown(),e.model.get("phoneValid")&&e.model.set("phoneValid",!1)},initializeAutocompletes:function(){var e=this;e.$el.find('input[name="carrierLabel"]').blur(function(){var e=$.Event("keydown");e.keyCode=$.ui.keyCode.ENTER,$(this).trigger(e)}).autocomplete({autoFocus:!0,source:function(e,t){for(var i=[{label:"Aio Wireless",value:"aio"},{label:"Alltel",value:"alltel"},{label:"Ameritech",value:"ameritech"},{label:"AT&T",value:"at&t"},{label:"Bell Atlantic",value:"bell-atlantic"},{label:"Bellsouth Mobility",value:"bellsouthmobility"},{label:"BlueSkyFrog",value:"blueskyfrog"},{label:"Boost Mobile",value:"boost"},{label:"Cellular South",value:"cellularsouth"},{label:"Comcast PCS",value:"comcast"},{label:"Cricket",value:"cricket"},{label:"kajeet",value:"kajeet"},{label:"Metro PCS",value:"metropcs"},{label:"Nextel",value:"nextel"},{label:"Powertel",value:"powertel"},{label:"PSC Wireless",value:"pscwireless"},{label:"Qwest",value:"qwest"},{label:"Southern Link",value:"southernlink"},{label:"Sprint PCS",value:"sprint"},{label:"Suncom",value:"suncom"},{label:"T-Mobile",value:"t-mobile"},{label:"Tracfone",value:"tracfone"},{label:"Telus Mobility",value:"telus-mobility"},{label:"Virgin Mobile",value:"virgin"},{label:"Verizon Wireless",value:"verizon"},{label:"Aliant (Canada)",value:"aliant-canada"},{label:"Beeline",value:"beeline-ua"},{label:"Bell Mobility (Canada)",value:"bellmobility-canada"},{label:"BPL Mobile",value:"bpl-mobile"},{label:"Claro (Brazil)",value:"claro-brazil"},{label:"Claro (Nicaragua)",value:"claro-nicaragua"},{label:"Du (UAE)",value:"du-arab-emirates"},{label:"E-Plus (Germany)",value:"e-plus-germany"},{label:"Etisalat (UAE)",value:"etisalat-arab-emirates"},{label:"Fido",value:"fido-canada"},{label:"Manitoba Telecom (Canada)",value:"manitobatelecom-canada"},{label:"Mobinil",value:"mobinil-egypt"},{label:"Mobistar (Belgium)",value:"mobistar-belgium"},{label:"Mobitel",value:"mobitel"},{label:"Movistar (Spain)",value:"movistar-spain"},{label:"NorthernTel (Canada)",value:"northerntel-canada"},{label:"o2 (Germany)",value:"o2-germany"},{label:"o2 (UK)",value:"o2-uk"},{label:"Orange (Mumbai)",value:"orange-mumbai"},{label:"Orange (Netherlands)",value:"orange-netherlands"},{label:"Orange (UK)",value:"orange-uk"},{label:"Rogers Wireless",value:"rogers-wireless"},{label:"Rogers (Canada)",value:"rogers-canada"},{label:"SaskTel (canada)",value:"sasktel-canada"},{label:"SFR (France)",value:"sfr-france"},{label:"T-Mobile (Austria)",value:"t-mobile-austria"},{label:"T-Mobile (Germany)",value:"t-mobile-germany"},{label:"T-Mobile (UK)",value:"t-mobile-uk"},{label:"Telebec (Canada)",value:"telebec-canada"},{label:"Telefonica (Spain)",value:"telefonica-spain"},{label:"Telus (Canada)",value:"telus-canada"},{label:"Virgin (Canada)",value:"virgin-canada"},{label:"Vodafone (Germany)",value:"vodafone-germany"},{label:"Vodafone (Egypt)",value:"vodafone-egypt"},{label:"Vodafone (UK)",value:"vodafone-uk"},{label:"Vodafone (Italy)",value:"vodafone-italy"},{label:"Vodafone (Japan - Chuugoku)",value:"vodafone-jp-chuugoku"},{label:"Vodafone (Japan - Hokkaido)",value:"vodafone-jp-hokkaido"},{label:"Vodafone (Japan - Hokuriko)",value:"vodafone-jp-hokuriko"},{label:"Vodafone (Japan - Kansai)",value:"vodafone-jp-kansai"},{label:"Vodafone (Japan - Osaka)",value:"vodafone-jp-osaka"},{label:"Vodafone (Japan - Kanto)",value:"vodafone-jp-kanto"},{label:"Vodafone (Japan - Koushin)",value:"vodafone-jp-koushin"},{label:"Vodafone (Japan - Tokyo)",value:"vodafone-jp-tokyo"},{label:"Vodafone (Japan - Kyuushu)",value:"vodafone-jp-kyuushu"},{label:"Vodafone (Japan - Okinawa)",value:"vodafone-jp-okinawa"},{label:"Vodafone (Japan - Shikoku)",value:"vodafone-jp-shikoku"},{label:"Vodafone (Japan - Touhoku)",value:"vodafone-jp-touhoku"},{label:"Vodafone (Japan - Niigata)",value:"vodafone-jp-niigata"},{label:"Vodafone (Japan - Toukai)",value:"vodafone-jp-toukai"},{label:"Vodafone (Spain)",value:"vodafone-spain"}],n=e.term.toLowerCase().split(/\s|-/g),a=[],o=0;o<i.length;o++){for(var r=0;r<n.length;r++)n[r].length>0&&(-1!=i[o].label.toLowerCase().indexOf(n[r])||-1!=i[o].label.toLowerCase().replace(/-|&/g,"").indexOf(n[r]))&&(i[o].matches=(i[o].matches||0)+1);i[o].matches>0&&a.push(i[o])}a.sort(function(e,t){return t.matches-e.matches}),a=a.slice(0,5),0==a.length&&a.push({label:"No carriers found",value:""}),t(a)},select:function(t,i){var n=i.item.label,a=i.item.value;return-1!=["at&t"].indexOf(a)&&(n="Not supported",a="Not supported"),""==n&&(a=""),$(t.target).val(n),e.$el.find('input[name="carrier"]').val(a),e.update(),debug()(t,i),!1}})},setElementsModalImageFlag:function(){this._$addElementModalBtn=this.$el.find(".triggerElementModal"),this._$addElementModal=$("#elementsModal"),this.imagesHaveBeenLoadedAlreadyFlag=this.imagesHaveBeenLoadedAlreadyFlag||!1;var e=function(e){var t=$(this),i=t.attr("data-imgurl");t.attr("src",i)},t=function(t){$(this).find("img").each(e)};this._$addElementModalBtn.on("click",function(e){var i;this.imagesHaveBeenLoadedAlreadyFlag||(this.imagesHaveBeenLoadedAlreadyFlag=!0,i=this._$addElementModal.find(".elementItem"),i.each(t))}.bind(this))},afterRender:function(){var e=this;e.formElementsSettingsModule.renderFormElements();var t=this.model.get("ownerEmail");try{var i=t.split(",");for(var n in i){var a=this.$el.find(".ownerEmailWrapper").addPrototype(null,{speed:"instant"}),o={ownerEmailPart:i[n]};a.objectToForm(o)}}catch(e){debug()("User is not logged in yet!")}this.setConfirmationEmailHack(),this.updateAdminMessage(),this.initializeWixDropdowns(),this.validateExternalFields(),this.updateConditionals(),this.initializeInputs(),this.makeSortable(".formElementsWrapper",".sort",!0),this.setElementsModalImageFlag(),this.populateSubjectLineOptions(),"wix"==HOST&&(Wix.Settings.getDashboardAppUrl(function(t){t?t+="&powr_app_id="+e.model.meta.id:t="/apps/"+e.model.meta.id+"/responses",debug()("Setting dashboard to "+t),e.$el.find(".openDashboard").attr("href",t)}),Wix.Dashboard.getEditorUrl(function(t){e.$el.find(".openSite").attr("href",t)}))},renderEmailMediaBars:function(){this.$el.find('.ownerEmail:not(".prototype")').each(function(){var e=$(this).find('[name="ownerEmailPart"]').val()||"Email";$(this).find(".mediaBar .title").html(truncate(e,"35")),$(this).find(".mediaBar .image").html('<i class="fa fa-envelope-o"></i>')})},afterAdd:function(e){e.find('input[type="text"]').val("")}}),formBuilderAppView=appView.extend({beforeInitialize:function(){var e=this;try{var t=JSON.parse(localStorage.getItem("Form_"+e.model.meta.id+"_locals")),i=new Date(localStorage.getItem("Form_"+e.model.meta.id+"_timestamp"));new Date-i>6048e5?(localStorage.removeItem("Form_"+e.model.meta.id+"_locals"),localStorage.removeItem("Form_"+e.model.meta.id+"_timestamp")):e.model.setLocals(t)}catch(e){}e.formElementsViewModule=new formElementsViewModule(this,{}),e.model.formElementsViewModule=e.formElementsViewModule,e.model.view=e},nextStep:function(){this.formElementsViewModule.saveData(),this.model.get("locals").lastStep&&this.submitForm(),this.formElementsViewModule.renderFormElements("next")},previousStep:function(){this.formElementsViewModule.renderFormElements("previous")},afterCorrectPassword:function(){this.formElementsViewModule.renderFormElements(),this.$el.find("#formBackButton").hide()},afterInitialize:function(){var e=this;this.$el.on("keyup change",".paypalQuantity",function(){var t=$(this).val();(isNaN(t)||parseInt(Number(t))!=t||isNaN(parseInt(t,10))||t<1)&&$(this).val(1),e.formElementsViewModule.calculatePrice()}),this.$el.on("click","#quantity-up, #quantity-down",function(t){"quantity-up"===(t.target.id||$(t.target).parent().prop("id"))?e.model.set({paypalQuantity:parseInt(e.model.get("paypalQuantity"))+1}):e.model.set({paypalQuantity:parseInt(e.model.get("paypalQuantity"))-1||1})}),this.$el.on("change",'input[type="text"], input[type="date"], input[type="time"], input[type="email"], input[type="password"], input[type="hidden"], input[type="number"], textarea, select, input[type="radio"]:checked, .multipleCheckbox, .checkbox input[type="checkbox"], input.fileURL, input[type="tel"], input[type="url"], input[type="signature"], .addressWrapper',function(t){if("protectionForm"!==$(t.target).parent().prop("id")){var i=$(t.target).closest(".formElement"),n=parseInt(i.prop("id")),a=e.model.attributes.locals.data[n];a&&("multipleCheckbox"===a.type?(a.selectedOptions=[],$(t.target).closest(".formElement").find(":checked").each(function(e,t){a.selectedOptions.push($(t).val())}),a.selectedOptions.length&&(i.removeClass("requiredAndBlank"),i.find("input, textarea, select, label, button").removeClass("requiredAndBlank"),i.find("#"+a.idx.toString()+"_errors").remove())):"radio"===a.type||"select"===a.type||"radioimage"===a.type?(a.selectedOption=$(t.target).closest(".formElement").find(":checked").val(),a.selectedOption&&(i.removeClass("requiredAndBlank"),i.find("input, textarea, select, label, button").removeClass("requiredAndBlank"),i.find("#"+a.idx.toString()+"_errors").remove())):"checkbox"===a.type?(a.checked=$(t.target).prop("checked"),a.checked&&(i.removeClass("requiredAndBlank"),i.find("input, textarea, select, label, button").removeClass("requiredAndBlank"),i.find("#"+a.idx.toString()+"_errors").remove())):"address"===a.type?$(t.target).closest(".formElement").find("input, select").each(function(e,t){a[t.name]=$(t).val(),a[t.name]&&(i.removeClass("requiredAndBlank"),i.find("input, textarea, select, label, button").removeClass("requiredAndBlank"),i.find("#"+a.idx.toString()+"_errors").remove())}):"date"===a.type?$(t.target).closest(".formElement").find("input").each(function(t,n){var o=e.getDateString(n);a[$(n).attr("pwr-mod-attr")]=o,a[$(n).attr("pwr-mod-attr")]&&(i.removeClass("requiredAndBlank"),i.find("input, textarea, select, label, button").removeClass("requiredAndBlank"),i.find("#"+a.idx.toString()+"_errors").remove())}):"signature"===a.type||("url"===a.type?a.value=urlFormat($(t.target).val()):a.value=$(t.target).val()),(a.value&&"email"!==a.type||"email"===a.type&&a.value.indexOf("@")>-1)&&(i.removeClass("requiredAndBlank"),i.find("#invalidEmail").remove(),i.find("input, textarea, select, label, button").removeClass("requiredAndBlank"),i.find("#"+a.idx.toString()+"_errors").remove()),e.model.formElementsViewModule.updateConditionalElements(),e.model.formElementsViewModule.calculatePrice())}}),this.$el.on("upload_start",".fileUploadInput",function(t){e.model.setLocals({upoadInProgress:!0})}),this.$el.on("upload_fail",".fileUploadInput",function(t){e.model.setLocals({upoadInProgress:!1})}),this.$el.on("upload_success",".fileUploadInput",function(t){var i=parseInt($(t.target).closest(".formElement").prop("id")),n=e.model.attributes.locals.data[i],a=$(t.target).closest(".formElement").find(".fileURL").val();n.value=a,e.model.setLocals({upoadInProgress:!1})}),this.$el.on("click",".triggerPayment",function(){e.$el.find(".paypalForm ").submit()}),this.$el.on("click","#formBackButton",function(t){t.preventDefault(),$(this).blur(),e.previousStep()}),this.$el.on("click","#submitButton",function(t){return t.preventDefault(),debug()("Form submit triggered. Event:",t),!!e.formElementsViewModule.validate()&&(e.model.get("captchaRequired")&&!e.model.get("paymentRequired")&&e.model.get("locals").lastStep?""!==grecaptcha.getResponse(e.model.get("locals").captchaID)&&e.submitForm():e.model.get("multistepForm")?e.nextStep():e.submitForm(),!1)}),e.model.get("captchaRequired")&&setInterval(function(){if($(".g-recaptcha-bubble-arrow").length>0&&1==$(".g-recaptcha-bubble-arrow").parent().css("opacity")){e.$el.css("height","auto");var t=e.$el.height(),i=.5*$(".g-recaptcha-bubble-arrow").parent().height();e.$el.height(t+i)}else e.$el.css("height","auto")},2e3),this.$el.on("click",".printer",function(){if(e.model.get("locals").isDirty||!e.model.meta.saved)return void $(".saveModal").modal("show");window.open("/plugins/form-builder/view?form-builder-print=true&id="+e.model.meta.id)}),e.model.setLocals({loadTime:(new Date).getTime()}),"wix"==HOST&&this.$el.on("click",".powrMark a",function(){var e=Math.round(.7*screen.width),t=screen.height;return window.open($(this).attr("href"),"","width="+e+",height="+t+",scrollbars=1"),!1})},getDateString:function(e){var t=$(e).closest(".formElement").prop("id"),i=this.model.get("locals").data[t],n=new Date($(e).val()),a=n.getHours(),o=i.istwentyfour?a:a%12==0?12:a%12,r=n.getMinutes();r<10&&(r="0"+r);var s=i.istwentyfour?"":a>12?"PM":"AM";return n.getMonth()+1+"/"+n.getDate()+"/"+n.getFullYear()+", "+o+":"+r+s},formatForPrint:function(){if($("html").css("margin","5%"),$(".formBuilder").css("max-width","100%"),$(".formBuilder").css("border","none"),$(".formBuilder").css("text-align","center"),$("#editMe").hide(),$(".formTitle").css("text-align","center"),$(".adminAppInfo").hide(),$(".errors").hide(),$(".printer").hide(),$(".success").hide(),$(".triggerPayment").hide(),$(".formResponses").hide(),$(".resultsButton").hide(),$(".datePickerParent").hide(),$(".submitButton").hide(),$("#spamDetection").hide(),$(".lengthSummary").hide(),$(".description").hide(),$(".honeypot").hide(),$(".stepLabel").hide(),$(".radio").removeClass("radio"),$(".checkbox").removeClass("checkbox"),$("input, textarea").prop("placeholder",""),$('[name="zip"]')[0]){var e=$('[name="zip"]')[0].outerHTML;e=e.replace("zip","country"),$('[name="country"]').replaceWith(e)}$(".fitText").css("display","block"),$(".lengthSummary").hide(),$(".buttonAndSummaryWrapper").hide(),$(".success").hide(),$("input, label, textarea").each(function(e,t){var i=t.getBoundingClientRect().top%1100,n=3*parseFloat($(t).css("height"));(i<n||i>1100-n)&&$(t).css("margin-top",n.toString()+"px")})},setMetaContent:function(){var e=this.model.get("description").length>0?this.model.get("description"):this.model.get("title"),t=this.model.get("title");this.writeMetaContent(e,t)},paymentsActive:function(){return this.model.get("paymentRequired")&&(parseFloat(this.model.get("locals").fullPrice)>0||this.model.get("paypalAllowUserToSpecifyPrice")&&$.inArray(this.model.get("paypalPurchaseType"),["Donate","BuyNow"])>-1)},getSubmitData:function(){var e=this,t=[];return this.model.get("locals").data.filter(function(e){return-1===$.inArray(e.type,["image","linebreak","step","spacer","label"])}).map(function(i){if(t.push(i.label),e.model.get("includeSkippedFields")||e.formElementsViewModule.elementIsPresent(i)){var n;if("multipleCheckbox"===i.type)n=i.selectedOptions?i.selectedOptions.join(", "):"";else if("radio"===i.type||"select"===i.type||"radioimage"===i.type)n=i.selectedOption;else if("checkbox"===i.type)void 0===(n=i.checked)&&(n=!!i.defaultChecked);else if("address"===i.type)n=[i.address1,i.address2,i.city,i.state,i.zip,i.country].join(", ");else{if("date"===i.type){if(!e.model.get("includeSkippedFields")&&!i.dateTimeHidden)return;if("date"===i.displayType)try{i.dateTimeHidden=i.dateTimeHidden.split(",")[0]}catch(e){}else if("time"===i.displayType)try{i.dateTimeHidden=i.dateTimeHidden.split(", ")[1]}catch(e){}if("both"===i.displayType&&i.nativeTimeElement){var a=e.$el.find("#"+i.idx).find('[type="date"]').val().split("-");date=a[1]+"/"+a[2]+"/"+a[0],i.datePickerContainer=date+" "+e.ensureTenCharacters(i.dateTimeHidden.split(" ")[1])}if(i.dateFormat&&"D"===i.dateFormat[0]&&(i.dateTimeHidden=e.euroDate(i.dateTimeHidden),i.datePickerContainer)){var o=i.datePickerContainer.split(" ");i.datePickerContainer=e.euroDate(o[0])+" "+o[1]}var n=$.inArray(i.displayType,["date","both"])&&!i.nativeTimeElement?i.dateTimeHidden:i.datePickerContainer;"date"===i.displayType&&(n=i.dateTimeHidden),"time"===i.displayType&&(n=i.dateTimeHidden);var r=e.$el.find("#"+i.idx).find(".ampm").val();return r&&(n=n.match("AM")?n.replace("AM",r):n.replace("PM",r)),{label:e.uniqueLabel(t,i),value:n,date_format:i.dateFormat,is_twenty_four:i.istwentyfour,exportField:i.exportField}}n="signature"===i.type?i.value||$("#signature-"+i.idx).next(".signatureImage").prop("src"):i.value}if(e.model.get("includeSkippedFields")||void 0!==n)return{label:e.uniqueLabel(t,i),type:i.type,value:n,exportField:i.exportField}}}).filter(function(e){return e})},uniqueLabel:function(e,t){var i=0;return e.forEach(function(e){i+=e===t.label?1:0}),i>1?t.label+"_"+i:t.label},euroDate:function(e){if(e){var t=e.split("/"),i=t[1],n=t[0];return t[0]=i,t[1]=n,t.join("/")}},ensureTenCharacters:function(e){return e.split("/").map(function(e){return e.length<2?"0"+e:e}).join("/")},submitForm:function(){var e=this,t=(this.$el.find(".realForm"),this.$el.find("#submitButton")),i=e.formElementsViewModule.currentPageData(),n=this.getSubmitData();if(this.model.get("locals").discountCode&&n.push({label:"Discount Code Used",type:"text",value:this.model.get("locals").discountCode,exportField:""}),e.formElementsViewModule.saveData(),!e.model.get("locals").uploadInProgress&&(debug()(i),!e.formElementsViewModule.preventMultipleSubmission()))if(e.formElementsViewModule.isLastPage()){if(e.model.get("paymentRequired")){var a=Math.floor(1e4*Math.random()+1)+"_"+(d=new Date).getTime();n.push({label:"Quantity",type:"paypalQuantity",value:e.$el.find(".paypalQuantity").val()}),e.$el.find(".paypalForm").find('input[name="quantity"]').val(1),e.$el.find('.paypalForm input[name="custom"]').val(JSON.stringify({response_token:a}))}else var a=null;e.model.setLocals({responseToken:a});var o={appId:e.model.meta.id,data:n,confirmationEmail:e.getConfirmationEmail(n),subscribeEmail:e.getMailchimpSubscribeEmail(),responseToken:e.model.get("locals").responseToken};if(debug()("All data is ",n),e.paymentsActive()){e.$el.find('.powrForm [name="data"]').val(JSON.stringify(o)),e.$el.find(".paypalForm").find('[name="amount"],[name="a3"]').val(e.model.get("locals").fullPrice),e.$el.find('.powrForm [name="paypal_data"]').val(JSON.stringify($(".paypalForm").formToObject())),o.paypal_data=JSON.stringify($(".paypalForm").formToObject()),o.submit_type="form";var r=$.param(o);r.length<2e3&&e.$el.find(".powrForm").attr("action","/app_form_response?"+r),e.$el.find(".powrForm").submit()}else{var s={url:"/app_form_response.json",data:o,type:"POST",buttonElement:t,errorsElement:e.$el.find("#validationErrors")};ajaxController(s,function(t){t.success&&e.afterSubmission()})}if(e.postSizeToSocket(),"wix"==HOST&&"site"==window.VIEW_MODE){var l="",u="",c="",p=[],m=[],h=[],f=[],g=!1,v=!1,b=!1;for(var y in n)0==g&&"email"==n[y].type&&n[y].value.length>0?(l=n[y].value,p.push({name:"email",value:l}),m.push({tag:"main",email:l}),g=!0):0==v&&"phone"==n[y].type&&n[y].value.length>0?(u=n[y].value,p.push({name:"phone",value:u}),h.push({tag:"main",phone:u}),v=!0):0==b&&"address"==n[y].type&&n[y].value.length>0?(c=n[y].value,p.push({name:"address",value:c}),b=!0):void 0!=n[y].label&&void 0!=n[y].value&&f.push({name:n[y].label,value:n[y].value});if($.inArray(e.model.meta.app_type,["formBuilder","contactForm","poll","wixDev","localDev","wixLocal"])>-1&&(p.length>0||m.length>0)){var _={type:Wix.Activities.Type.FORM_CONTACT_FORM,info:{content:{},additionalFields:f},details:{additionalInfoUrl:null,summary:"Adding contact from POWr"},contactUpdate:{emails:m,phones:h}};debug()("Sending contact activity to wix: ",_),Wix.Activities.postActivity(_,function(e){debug()("Wix activity success:",e)},function(e){debug()("Wix activity failure:",e)})}if($.inArray(e.model.meta.app_type,["mailingList"])>-1&&l.length>0){var _={type:Wix.Activities.Type.SUBSCRIPTION_FORM,info:{email:l,phone:u},details:{additionalInfoUrl:null,summary:"Adding contact from POWr"},contactUpdate:{emails:m,phones:h}};debug()("Sending subscription activity to wix: ",_),Wix.Activities.postActivity(_,function(e){debug()("Wix activity success:",e)},function(e){debug()("Wix activity failure:",e)})}}}else e.model.setLocals({data:n}),e.formElementsViewModule.renderPage(e.model.get("locals").page+1)},getMailchimpSubscribeEmail:function(){var e=this.model.get("locals").data.filter(function(e){return e.subscribeToMailchimp});if(e.length)return e[0].value},getConfirmationEmail:function(e){var t=null;if(this.model.get("locals").data.forEach(function(e){e.sendConfirmationEmail&&(t=e)}),t)return t.value},afterSubmission:function(){var e=this,t=this.$el.find("#submitButton");this.$el.find(".formBackButton").hide(),this.$el.find("[role='progressbar']").css("width","100%"),this.$el.find(".progress-bar-percentage").html("100%"),this.$el.find(".progressBarBox, .progress-bar-percentage").hide(),e.model.get("preventMultiple")&&setCookie("powr_form_"+e.model.meta.id,"blocked",14);try{localStorage.removeItem("Form_"+e.model.meta.id+"_locals"),localStorage.removeItem("Form_"+e.model.meta.id+"_timestamp")}catch(e){}t.fadeOut("fast",function(){switch(debug()("Button faded out"),e.model.get("afterSubmission")){case"clearAndPrevent":e.$el.find(".realForm input, .realForm textarea, .realForm select").prop("disabled",!0),e.$el.find(".success").fadeIn("fast").trigger("change"),e.paymentsActive()&&e.$el.find(".triggerPayment").fadeIn();break;case"clearAndAllow":e.model.syncLocalData(!0),e.render(),e.$el.find("[role='progressbar']").css("width","100%"),e.$el.find(".progress-bar-percentage").html("100%"),e.$el.find(".success").fadeIn("fast").trigger("change"),e.$el.find(".triggerPayment").hide();break;case"redirect":if(e.model.get("paymentRequired")&&"redirect"==e.model.get("afterSubmission")&&e.model.get("redirectLink").length>0)e.$el.find(".realForm input, .realForm textarea, .realForm select").prop("disabled",!0),e.$el.find(".success").fadeIn("fast").trigger("change");else{e.render(),debug()("Re-rendering and setting location");var t=urlFormat(e.model.get("redirectLink"));-1==t.indexOf("?")&&(t=t.replace("#","?#")),"http://"!==t?window.top.location.href=t:(e.$el.find(".formBuilder").slideUp(function(){e.postSizeToSocket()}),e.$el.find(".success").fadeIn("fast"))}e.paymentsActive()&&e.$el.find(".triggerPayment").fadeIn();break;case"hide":e.$el.find(".redirectLink").slideUp(),e.$el.find(".successText").slideUp(),e.$el.find(".formBuilder").slideUp(function(){e.postSizeToSocket()});break;case"responses":e.$el.find(".success").fadeIn("fast").trigger("change"),e.$el.find(".progress").hide(),e.showResponses(),e.paymentsActive()&&e.$el.find(".triggerPayment").fadeIn()}e.postSizeToSocket()})},showResponses:function(){var e=this,t="/form-responses/"+this.model.meta.id+"/show";this.$el.find(".linkResponses a").attr("href",t),e.$el.find(".realForm").find(".dynamicElements").removeClass("visible").slideUp(),e.$el.find(".recaptchaContent").slideUp();var i=e.$el.find(".formResponses");i.slideDown(),0==e.model.get("data").filter(function(e){return!!e.showResponse}).length||i.find(".linkResponses").slideDown()},afterRender:function(){var e=this,t=e.model.get("locals").successMessageDraft;t&&(e.$el.find("#successAlert").text(t).fadeIn("fast"),setTimeout(function(){e.$el.find("#successAlert").fadeOut("fast")},5e3)),this.formElementsViewModule.renderFormElements(),this.updatePowrMarkLink()},updatePowrMarkLink:function(){},buildCaptcha:function(){if(!window.location.href.match("form-builder-print")&&this.model.get("captchaRequired")&&""===$(".captchaImgWrapper").html()){try{var e=grecaptcha.render($(".captchaImgWrapper")[0],{sitekey:"6Le7gisUAAAAAL3VennxOM93GaltIhkqNXlTnCOA"});this.model.setLocals({captchaID:e})}catch(e){}$(".captchaImgWrapper").animate({opacity:1})}},initializeDateTimePickers:function(){function e(e){var i=e.findAndSelf("[pwr-mod-attr='formatElement']").attr("data-format"),a=e.find("input").fxnMap(function(){return $(this)}).filter(function(e){return!!e.attr("data-form-type")})[0];switch(a.attr("data-form-type")){case"datetime":!function(e,i){var n=e.find(".dateSelector"),a=e.find(".timePicker"),o={using_native_inputs:t,$body:e,use_local:!0,formatString:i,dateSelectEls:n,timeSelectEls:a};new POWrDateTimeComponentWithIncrementer(o).on("change",function(e){})}(e,i);break;case"date":!function(e,i){var o={use_local:!0,formatString:i,using_native_inputs:t,$body:e,dateState:n};new POWrDatePickerComponent(o).on("change",function(e){a.attr("value",e.dateState.toLocaleISOString()),a.val(e.dateState.toLocaleISOString()),$(e).find("input").trigger("change")})}(e,i);break;case"time":!function(e,i){var o={use_local:!0,formatString:i,using_native_inputs:t,$body:e,timeState:n};new POWrTimePickerComponent(o).on("change",function(e){a.attr("value",e.timeState.toLocaleISOString()),a.val(e.timeState.toLocaleISOString()),$(e).find("input").trigger("change")})}(e,i);break;default:throw"Bad stuff, couldnt find input type"}a.val(n.toLocaleISOString()),a.attr("value",n.toLocaleISOString())}var t=usingHtml5Datetime(),i=this.$el.find(".datetimeWrapper"),n=moment();i.each(function(){e($(this))})},_initializeDateTimePickers:function(){this.$el.find(".datetimeWrapper").each(function(){function e(){var e=r.find(".datetime");d=e.data("is-twenty-four")||!1;var t=r.find(".ampm").val(),i=new Date;if(usingHtml5Datetime()){var n=r.find(".htmlDate"),a=r.find(".htmlTime"),o=0==n.length?[2e3,1,1]:n.val().split("-");i.setFullYear(parseInt(o[0])||2e3),i.setDate(1),i.setMonth((parseInt(o[1])||1)-1),i.setDate(parseInt(o[2])||1);var s=0==a.length?[0,0]:a.val().split(":");i.setHours(parseInt(s[0])||0),i.setMinutes(parseInt(s[1])||0)}else{if(r.find(".dateSelector").length>0){var l=r.find(".dateSelector").datepicker("getDate");i.setFullYear($.datepicker.formatDate("yy",l)),i.setDate(1),i.setMonth(parseInt($.datepicker.formatDate("m",l))-1),i.setDate($.datepicker.formatDate("d",l)),debug()("Date var",l)}d?i.setHours(parseInt(r.find(".hour").val())||0):"PM"==t?i.setHours((parseInt(r.find(".hour").val())||0)+12):i.setHours(parseInt(r.find(".hour").val())||0),i.setMinutes(parseInt(r.find(".minute").val())||0)}(i.setSeconds(0),r.find(".datetime").data("use-local-time"))?i.toLocaleString():i.toString();e.val(g({date:i,is_twentyfour:d,type:e.data("form-type")})),debug()("Formbuilder Datetime string is "+e.val())}function t(){var t=parseInt(r.find(".hour").val());t<23&&d?r.find(".hour").val(o(t+1)):t<12?r.find(".hour").val(t+1):d?r.find(".hour").val(o(0)):r.find(".hour").val(1),e()}function i(){var t=parseInt(r.find(".hour").val());d?t>0?r.find(".hour").val(o(t-1)):r.find(".hour").val(23):t>1?r.find(".hour").val(t-1):r.find(".hour").val(12),e()}function n(){var t=parseInt(r.find(".minute").val());t<59?r.find(".minute").val(o(t+1)):r.find(".minute").val(o(0)),e()}function a(){var t=parseInt(r.find(".minute").val());t>0?r.find(".minute").val(o(t-1)):r.find(".minute").val(o(59)),e()}function o(e){return e.length>1&&e<10?e:(e<10?"0":"")+e}var r=$(this),s=r.find(".datetime").val();if(debug()("Parsing datetime, current value is "+s),0==s.length)var l=new Date;else s.search("am")>-1?s=s.replace("am",""):s.search("pm")>-1&&(s=s.replace(/\d\d:/,function(e){return o(parseInt(e.substr(0,2))+12)+":"}),s=s.replace("pm","")),debug()("Datetime after am/pm parsing: "+s),s.search("/")>-1?l=new Date(s):(l=new Date,l.setHours(s.split(":")[0]),l.setMinutes(s.split(":")[1])),debug()("Datetime Object:",l);var d=r.find(".datetime").data("is-twenty-four")||!1,u=l.getHours(),c=l.getMinutes(),p=Array(3-u.toString().length).join("0")+p;c=Array(3-c.toString().length).join("0")+c;var m=p+":"+c;debug()("Parsed time is "+m+"; datetime obj is",l);var h=d?u:u%12==0?12:u%12,f=d?"":u>12?"PM":"AM";r.find(".hour").val(h),r.find(".minute").val(c),r.find(".ampm").val(f);var g=function(e){debug()("Stringify date called with opts ",e);var t=e.date,i=e.is_twentyfour||!1,n=t.getHours(),a=t.getMinutes(),o=t.getDate(),r=t.getMonth()+1,s=t.getFullYear(),l=i?n:n%12==0?12:n%12,d=i?"":n>12?"pm":"am",u=function(e){return e=e.toString(),e.length<2&&(e="0"+e),e},c=r+"/"+o+"/"+s,p=u(l)+":"+u(a)+d;return"date"==e.type?c:"time"==e.type?p:(e.type,c+" "+p)};$(this).find(".dateSelector").datepicker({onSelect:function(){e()}});var v=$(this).find(".dateSelector");v.length>0&&(v.change(function(){e()}),v.datepicker("setDate",l));var b=new Date,y=b.toLocaleTimeString();if(debug()("datestring: "+y),y.match(/am|pm/i)||b.toString().match(/am|pm/i))debug()("12 hour clock");else if(debug()("24 hour clock"),usingHtml5Datetime())r.find(".htmlTime").addClass("twentyfour");else{var u=r.find(".hour");u.addClass("twentyfour"),u.val(o(parseInt(u.val()))),r.find(".ampmPicker").hide()}r.find(".upHour").on("click",function(){t()}),r.find(".downHour").on("click",function(){i()}),r.find(".hour").on("blur",function(){var t=/^[+-]?\d+(\.\d+)?([eE][+-]?\d+)?$/,i=$(this).val(),n=$(this).parents(".datePickerParent").first().hasClass("twentyFour"),a=n?24:12;t.test(i)?i>a?$(this).val(a):$(this).val(i):$(this).val(1),e()}),r.find(".upMinute").on("click",function(){n()}),r.find(".downMinute").on("click",function(){a()}),r.find(".minute").on("blur",function(){var t=/^[+-]?\d+(\.\d+)?([eE][+-]?\d+)?$/,i=$(this).val();t.test(i)?i>59?$(this).val(59):$(this).val(o(i)):$(this).val(o(0)),e()}),r.find(".minute").on("keydown",function(e){return 38==e.keyCode?(n(),!1):40==e.keyCode?(a(),!1):void 0}),r.find(".hour").on("keydown",function(e){return 38==e.keyCode?(t(),!1):40==e.keyCode?(i(),!1):void 0}),r.find(".ampm").on("keydown",function(e){if(38==e.keyCode||40==e.keyCode)return $(this).val("AM"==$(this).val()?"PM":"AM"),!1}),r.find(".upAmpm, .downAmpm").on("click",function(){var t=r.find(".ampm").val();debug()(t),"PM"==t?r.find(".ampm").val("AM"):r.find(".ampm").val("PM"),e()}),r.find(".ampm").on("blur",function(){var t=$(this).val().toUpperCase();"PM"!=t&&"AM"!=t?$(this).val("PM"):$(this).val(t),e()}),e()})}}),i(7)}),window.usingHtml5Datetime=function(){return isMobile()},window.mailingListChosen=function(e){debug()("Called",e),APP_MODEL.set({mailchimpList:e.list_id,mailchimpListName:e.name}),$('[name="subscribeToMailchimp"]').prop("checked",!0),APP_MODEL.attributes.data.map(function(e,t){"email"===e.type&&(APP_MODEL.attributes.data[t].subscribeToMailchimp=!0)}),APP_SETTINGS.initializeCheckboxes(),APP_SETTINGS.initializeWixCheckboxes(),APP_SETTINGS.updateConditionals()}},860:function(module,exports,__webpack_require__){(function(process,global){var __WEBPACK_AMD_DEFINE_RESULT__;/*
 * [js-sha1]{@link https://github.com/emn178/js-sha1}
 *
 * @version 0.6.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */
!function(){"use strict";function Sha1(e){e?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}var root="object"==typeof window?window:{},NODE_JS=!root.JS_SHA1_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS&&(root=global);var COMMON_JS=!root.JS_SHA1_NO_COMMON_JS&&"object"==typeof module&&module.exports,AMD=__webpack_require__(239),HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[],createOutputMethod=function(e){return function(t){return new Sha1(!0).update(t)[e]()}},createMethod=function(){var e=createOutputMethod("hex");NODE_JS&&(e=nodeWrap(e)),e.create=function(){return new Sha1},e.update=function(t){return e.create().update(t)};for(var t=0;t<OUTPUT_TYPES.length;++t){var i=OUTPUT_TYPES[t];e[i]=createOutputMethod(i)}return e},nodeWrap=function(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(e){if("string"==typeof e)return crypto.createHash("sha1").update(e,"utf8").digest("hex");if(e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(void 0===e.length)return method(e);return crypto.createHash("sha1").update(new Buffer(e)).digest("hex")};return nodeMethod};Sha1.prototype.update=function(e){if(!this.finalized){var t="string"!=typeof e;t&&e.constructor===root.ArrayBuffer&&(e=new Uint8Array(e));for(var i,n,a=0,o=e.length||0,r=this.blocks;a<o;){if(this.hashed&&(this.hashed=!1,r[0]=this.block,r[16]=r[1]=r[2]=r[3]=r[4]=r[5]=r[6]=r[7]=r[8]=r[9]=r[10]=r[11]=r[12]=r[13]=r[14]=r[15]=0),t)for(n=this.start;a<o&&n<64;++a)r[n>>2]|=e[a]<<SHIFT[3&n++];else for(n=this.start;a<o&&n<64;++a)i=e.charCodeAt(a),i<128?r[n>>2]|=i<<SHIFT[3&n++]:i<2048?(r[n>>2]|=(192|i>>6)<<SHIFT[3&n++],r[n>>2]|=(128|63&i)<<SHIFT[3&n++]):i<55296||i>=57344?(r[n>>2]|=(224|i>>12)<<SHIFT[3&n++],r[n>>2]|=(128|i>>6&63)<<SHIFT[3&n++],r[n>>2]|=(128|63&i)<<SHIFT[3&n++]):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++a)),r[n>>2]|=(240|i>>18)<<SHIFT[3&n++],r[n>>2]|=(128|i>>12&63)<<SHIFT[3&n++],r[n>>2]|=(128|i>>6&63)<<SHIFT[3&n++],r[n>>2]|=(128|63&i)<<SHIFT[3&n++]);this.lastByteIndex=n,this.bytes+=n-this.start,n>=64?(this.block=r[16],this.start=n-64,this.hash(),this.hashed=!0):this.start=n}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha1.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=EXTRA[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Sha1.prototype.hash=function(){var e,t,i,n=this.h0,a=this.h1,o=this.h2,r=this.h3,s=this.h4,l=this.blocks;for(t=16;t<80;++t)i=l[t-3]^l[t-8]^l[t-14]^l[t-16],l[t]=i<<1|i>>>31;for(t=0;t<20;t+=5)e=a&o|~a&r,i=n<<5|n>>>27,s=i+e+s+1518500249+l[t]<<0,a=a<<30|a>>>2,e=n&a|~n&o,i=s<<5|s>>>27,r=i+e+r+1518500249+l[t+1]<<0,n=n<<30|n>>>2,e=s&n|~s&a,i=r<<5|r>>>27,o=i+e+o+1518500249+l[t+2]<<0,s=s<<30|s>>>2,e=r&s|~r&n,i=o<<5|o>>>27,a=i+e+a+1518500249+l[t+3]<<0,r=r<<30|r>>>2,e=o&r|~o&s,i=a<<5|a>>>27,n=i+e+n+1518500249+l[t+4]<<0,o=o<<30|o>>>2;for(;t<40;t+=5)e=a^o^r,i=n<<5|n>>>27,s=i+e+s+1859775393+l[t]<<0,a=a<<30|a>>>2,e=n^a^o,i=s<<5|s>>>27,r=i+e+r+1859775393+l[t+1]<<0,n=n<<30|n>>>2,e=s^n^a,i=r<<5|r>>>27,o=i+e+o+1859775393+l[t+2]<<0,s=s<<30|s>>>2,e=r^s^n,i=o<<5|o>>>27,a=i+e+a+1859775393+l[t+3]<<0,r=r<<30|r>>>2,e=o^r^s,i=a<<5|a>>>27,n=i+e+n+1859775393+l[t+4]<<0,o=o<<30|o>>>2;for(;t<60;t+=5)e=a&o|a&r|o&r,i=n<<5|n>>>27,s=i+e+s-1894007588+l[t]<<0,a=a<<30|a>>>2,e=n&a|n&o|a&o,i=s<<5|s>>>27,r=i+e+r-1894007588+l[t+1]<<0,n=n<<30|n>>>2,e=s&n|s&a|n&a,i=r<<5|r>>>27,o=i+e+o-1894007588+l[t+2]<<0,s=s<<30|s>>>2,e=r&s|r&n|s&n,i=o<<5|o>>>27,a=i+e+a-1894007588+l[t+3]<<0,r=r<<30|r>>>2,e=o&r|o&s|r&s,i=a<<5|a>>>27,n=i+e+n-1894007588+l[t+4]<<0,o=o<<30|o>>>2;for(;t<80;t+=5)e=a^o^r,i=n<<5|n>>>27,s=i+e+s-899497514+l[t]<<0,a=a<<30|a>>>2,e=n^a^o,i=s<<5|s>>>27,r=i+e+r-899497514+l[t+1]<<0,n=n<<30|n>>>2,e=s^n^a,i=r<<5|r>>>27,o=i+e+o-899497514+l[t+2]<<0,s=s<<30|s>>>2,e=r^s^n,i=o<<5|o>>>27,a=i+e+a-899497514+l[t+3]<<0,r=r<<30|r>>>2,e=o^r^s,i=a<<5|a>>>27,n=i+e+n-899497514+l[t+4]<<0,o=o<<30|o>>>2;this.h0=this.h0+n<<0,this.h1=this.h1+a<<0,this.h2=this.h2+o<<0,this.h3=this.h3+r<<0,this.h4=this.h4+s<<0},Sha1.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,i=this.h2,n=this.h3,a=this.h4;return HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a]},Sha1.prototype.toString=Sha1.prototype.hex,Sha1.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,i=this.h2,n=this.h3,a=this.h4;return[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,i>>24&255,i>>16&255,i>>8&255,255&i,n>>24&255,n>>16&255,n>>8&255,255&n,a>>24&255,a>>16&255,a>>8&255,255&a]},Sha1.prototype.array=Sha1.prototype.digest,Sha1.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(20),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),e};var exports=createMethod();COMMON_JS?module.exports=exports:(root.sha1=exports,AMD&&void 0!==(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module))&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}()}).call(exports,__webpack_require__(28),__webpack_require__(17))},9:function(e,t,i){function n(){"free"==META.premium_status&&$(".loadingWrapper").show(),META.edit_me&&("jimdo"==META.external_id_type&&$("#editMe").css({marginTop:"20px"}),$("#editMe").fadeIn("fast")),$('link[rel="canonical"]').attr("href",baseUri()+"/plugins/view?id="+META.id),META.admin_debug_panel&&$("body").append(META.admin_debug_panel);var e=getURLParameter("mode");"page"==e?($("html").css({overflow:"auto"}),$("#appView").css({margin:"5% 15%"})):"scroll"==e?$("html").css({overflow:"auto"}):$("html").css({overflow:"hidden"})}function a(){function e(e){debug()("View received settings, evt is",e);try{var t=JSON.parse(e.data)}catch(e){return debug()("Couldn't json parse data: ",e),!1}var t=JSON.parse(e.data);if("loaded"==t.message){debug()("View received settings loaded. Evt origin is ",e.origin),function i(){window.PARENT_ORIGIN=e.origin,window.IFRAME_INDEX=t.data.iframe_index,"undefined"==typeof APP_MODEL?setTimeout(i,50):APP_MODEL.setLocals({parent_origin:e.origin,iframe_index:t.data.iframe_index,parent_window_height:t.data.parent_window_height,parent_window_width:t.data.parent_window_width})}();var i={message:"viewLoaded",data:{iframe_index:t.data.iframe_index}};parent.postMessage(JSON.stringify(i),e.origin),"undefined"!=typeof APP_VIEW&&APP_VIEW.postSizeToSocket()}if("loadView"==t.message)window.META=t.data.meta,window.GLOBALS=t.data.globals,window.CONTENT=t.data.content,loadView(),window.APP_MODEL.setLocals({parent_origin:e.origin,iframe_index:t.data.iframe_index});else if("showEdit"==t.message)$("#editMe, .adminAppInfo").fadeIn();else if("hideEdit"==t.message)$("#editMe, .adminAppInfo").hide();else if("update"==t.message){APP_MODEL.get("locals");for(var n in t.data.content)if("locals"==n)for(var a in t.data.content.locals)APP_MODEL.attributes.locals[a]=t.data.content.locals[a];else APP_MODEL.attributes[n]=t.data.content[n];APP_VIEW.render()}else"triggerPowrPopupClick"==t.message||"exitDocument"==t.message?APP_VIEW.openModal&&APP_VIEW.openModal(t.message):"platformData"==t.message&&(o(t.data),window.PLATFORM_DATA=t.data)}function t(){$("#editMe").popover({html:!0,trigger:"hover",delay:{hide:850},viewport:{selector:"#apps-view",padding:0},template:'<div class="popover" role="tooltip" style="font-size: 12px;margin-top: 5px;z-index: 10000000;"><div class="arrow"></div><div class="popover-content"></div></div>'})}try{window.APP_SOCKET=new s.Socket({onMessage:function(e){var t=JSON.parse(e);debug()("Message in app:",t),t.action&&"activate"==t.action?$("#editMe").fadeIn():t.action&&"deactivate"==t.action&&$("#editMe").fadeOut()}})}catch(e){debug()("Could not establish socket connection: "+e)}if(window.addEventListener?window.addEventListener("message",e):window.attachEvent("onmessage",e),$(document).on("click","#editMe",function(){"undefined"!=typeof SETTINGS_WINDOW&&SETTINGS_WINDOW.close();var e=Math.round(.9*screen.height),t=Math.round(screen.width-400-.1*screen.width),i="/apps/"+META.app_type+"/settings?id="+META.true_id+"&demo_mode="+META.demo_mode;void 0!=META.template&&(i+="&template="+META.template),window.SETTINGS_WINDOW=window.open(i,"POWr Editor","width=400,height="+e+",top=-1000,left="+t+",location=no,status=no","false")}),void 0==$(window).popover)return void setTimeout(function(){t()},2e3);t(),$(window).on("beforeunload",function(){if(APP_MODEL.get("locals").isDirty)return"You have unsaved work with a POWr Plugin! If you leave this page you will lose any unsaved changes."})}function o(e,t){if(debug()("Trying to load platform data"),"undefined"==typeof APP_MODEL)return void setTimeout(function(){o(e)},100);void 0===t&&(t={render:!0}),debug()("Loading platform data",e);var i=!1,n={};for(var a in e.content)void 0!==APP_MODEL.defaults()[a]&&APP_MODEL.attributes[a]!=e.content[a]&&(debug()("Default key: "+APP_MODEL.defaults()[a]),debug()("Response key: "+e.content[a]),"px"==(APP_MODEL.defaults()[a]+"").slice(-2)&&"px"!=(e.content[a]+"").slice(-2)?(APP_MODEL.attributes[a]=e.content[a]+"px",n[a]=e.content[a]+"px"):(APP_MODEL.attributes[a]=e.content[a],n[a]=e.content[a]),i=!0);i&&t.render&&APP_VIEW.render()}function r(){"undefined"!=typeof WIX_QA_APP_TYPE&&(window.wixStagingAppModel=window[WIX_QA_APP_TYPE+"AppModel"],window.wixLocalAppModel=wixStagingAppModel,window.localDevAppModel=wixStagingAppModel,window.wixIeLocalAppModel=wixStagingAppModel),window.VIEW_MODE=Wix.Utils.getViewMode(),"site"!=VIEW_MODE?loadView({use_backup_content:!0}):loadView({use_backup_content:!1}),Wix.addEventListener(Wix.Events.SETTINGS_UPDATED,function(e){debug()("Wix settings updated:",e),APP_MODEL.attributes=e,APP_MODEL.meta.saved=!0,APP_VIEW.render()}),Wix.addEventListener(Wix.Events.SITE_PUBLISHED,function(e){debug()("site published"),APP_MODEL.doSave({post_params:{wix_published:!0}})}),Wix.addEventListener(Wix.Events.COMPONENT_DELETED,function(e){debug()("app deleted"),APP_MODEL.doSave({post_params:{wix_deleted:!0}})}),"site"==VIEW_MODE&&Wix.currentMember(function(e){debug()("member details: ",e),e&&e.email&&setTimeout(function(){deliverHash(e.email)},2e3)})}var s=i(4);window.loadView=function(e){var t=void 0!==e&&void 0!=e.use_backup_content&&e.use_backup_content,i=void 0!==e&&void 0!=e.app_el?e.app_el:$("#appView");for(var a in GLOBALS)window[a]=GLOBALS[a];var r=META.app_type+"AppModel";if(META.soft_alias&&(window[r]=window[META.app_namespace+"AppModel"]),"development"!=window.ENVIRONMENT&&"staging"!=window.ENVIRONMENT||initializePlatformsForQA(),window.APP_MODEL=new window[r],t)for(var a in BACKUP_CONTENT)"undefined"!=BACKUP_CONTENT[a]&&APP_MODEL.set(a,BACKUP_CONTENT[a]);else for(var a in CONTENT)"undefined"!=CONTENT[a]&&APP_MODEL.set(a,CONTENT[a]);APP_MODEL.meta={};for(var a in META)"undefined"!=META[a]&&(APP_MODEL.meta[a]=META[a]);APP_MODEL.afterMount(),META.password_protected_template&&$("body").append(META.password_protected_template),window.APP_VIEW=new window[META.app_namespace+"AppView"]({el:"#"+i.attr("id"),model:APP_MODEL}),$.inArray(META.external_id_type,["weebly-integrated","design-editor","webydo","bookmark","cloudflare"])>-1&&(debug()("Updating through local storage"),setInterval(function(){if("undefined"!=typeof META){var e=localStorage.getItem("powr_data_"+META.id);if(void 0!=e&&null!=e&&"null"!=e){e=JSON.parse(e);APP_MODEL.get("locals");for(var t in e.content)if("locals"==t)for(var i in e.content.locals)APP_MODEL.attributes.locals[i]=e.content.locals[i];else APP_MODEL.attributes[t]=e.content[t];"undefined"!=typeof PLATFORM_DATA&&o(PLATFORM_DATA,{render:!1}),APP_VIEW.render(),localStorage.removeItem("powr_data_"+META.id)}}},100)),n()},$(function(){if($("#apps-view, #apps-facebook_view").length>0&&(loadView(),a()),$("#apps-cached_view").length>0)if(debug()("In apps cached view"),a(),"async"==getURLParameter("load"))debug()("Async loading"),window.LOAD_ME_INTERVAL=setInterval(function(){if("undefined"==typeof META||void 0==META){if("undefined"!=typeof PARENT_ORIGIN&&"undefined"!=typeof IFRAME_INDEX){var e={message:"loadMe",data:{iframe_index:IFRAME_INDEX}};parent.postMessage(JSON.stringify(e),PARENT_ORIGIN)}}else clearInterval(LOAD_ME_INTERVAL)},5e3);else{var e="/plugins/"+APP_DETAILS.slug+"/view.json?";getURLParameter("id")?e+="id="+getURLParameter("id"):getURLParameter("unique_label")?e+="unique_label="+getURLParameter("unique_label")+"&powr_token="+getURLParameter("powr_token")+"&user_label="+getURLParameter("user_label"):e+="powr_token="+getURLParameter("powr_token")+"&user_label="+getURLParameter("user_label"),getURLParameter("external_type")&&(e+="&external_type="+getURLParameter("external_type")),debug()("Calling to get app json. Url is "+e),ajaxController({url:e,type:"GET"},function(e){e.success?(debug()("Success getting view data"),window.META=e.meta,window.GLOBALS=e.globals,window.CONTENT=e.content,loadView()):debug()("Error getting view data")})}if($("#apps-wix_view").length>0&&r(),$("#apps-wix_cached_view").length>0){var e="/plugins/"+APP_DETAILS.slug+"/wix_view.json?"+originalQuery();ajaxController({url:e,type:"GET"},function(e){e.success?(window.META=e.meta,window.GLOBALS=e.globals,window.VIEW_MODE=Wix.Utils.getViewMode(),"site"!=VIEW_MODE?window.BACKUP_CONTENT=e.content:window.CONTENT=e.content,r()):debug()("Error getting wix view data")})}})}},[859]);
//# sourceMappingURL=formBuilder-804dba08f2f2fa923200.js.map